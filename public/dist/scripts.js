"use strict";$(function(){$(document).foundation(),$(window).on("load resize",function(){$("#footer");$(".title-bar").is(":visible")?$("#index-menu").removeClass("addFloat"):$("#index-menu").addClass("addFloat")}),$("#login").on("submit",function(e){e.preventDefault(),s();var o=$("#userName").val(),a=$("#userPassword").val();if(0!==o.length&&0!==a.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(o);t&&$.post("/login",{username:o,password:a}).fail(function(e){var s=e.responseJSON;400===e.status&&r(s[0].msg,"error"),401===e.status&&r(s.msg,"error")}).done(function(e){window.location.href="/user/home"})}else 0===o.length&&(n("userName"),$("#emptyFields").removeClass("hide")),0==a.length&&(n("userPassword"),$("#emptyFields").removeClass("hide"))}),$("#editProfile").on("submit",function(e){e.preventDefault(),s();var o=$("#userName").val(),a=$("#email").val();if(0!==o.length&&0!==a.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(o);t?$.post("/user/editProfile",{username:o,email:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?r(s[0].msg,"error"):r(s.msg,"error")}}).done(function(e){r(e.msg,"msg"),$("#loginLink").removeClass("hide"),$(".btns").addClass("hide")}):(n("userName"),r("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===o.length&&(n("userName"),$("#emptyFields").removeClass("hide")),0==a.length&&(n("email"),$("#emptyFields").removeClass("hide"))}),$("#confirmUser").on("submit",function(o){o.preventDefault(),s();var a=$("#username").val();0!==a.length?$.post("/verifyUser",{username:a}).fail(function(e){if(401===e.status){var s=e.responseJSON;r(s.msg,"error")}}).done(function(s){$("#username").val(""),$("#forgotPassword").removeClass("hide"),$("#confirmUser").addClass("hide"),e=s}):0===a.length&&(n("username"),$("#emptyFields").removeClass("hide"))}),$("#forgotPassword").on("submit",function(o){o.preventDefault(),s();var a=$("#newPassword").val(),t=$("#confirmPassword").val();0===a.length&&(n("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(n("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==a.length&&t!==a&&(n("confirmPassword"),$("#emptyFields").addClass("hide"),r("Confirm password doesn't match with the new password","error"));0!==a.length&&0!==t.length&&a===t&&$.post("/forgotPassword",{newPassword:a,user:e}).fail(function(e){if(400===e.status){var s=e.responseJSON;r(s.msg,"error")}}).done(function(e){r(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#signup").on("submit",function(e){e.preventDefault(),s();var o=$("#userName").val(),a=$("#userEmail").val(),t=$("#userPassword").val(),i=$("#confirmPassword").val();0===o.length&&(n("userName"),$("#emptyFields").removeClass("hide"));0===a.length&&(n("userEmail"),$("#emptyFields").removeClass("hide"));0===t.length&&(n("userPassword"),$("#emptyFields").removeClass("hide"));0===i.length&&(n("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==t.length&&0!==i.length&&i!==t&&(n("confirmPassword"),$("#emptyFields").addClass("hide"),showError("Confirm password doesn't match with password","error"));0!==o.length&&0!==t.length&&0!==i.length&&0!==a.length&&$.post("/signup",{username:o,password:t,email:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?r(s[0].msg,"error"):r(s.msg,"error")}}).done(function(e){r(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#reset").on("click",s);var e=null;function s(){$("#error").empty(),$("#msg").empty(),$("#emptyFields").addClass("hide"),$(".icon-error").remove()}function r(e,s){var r=$("#msgcont");0===r.length&&(r=$("<ul id='msgcont'></ul>")),r.append("<li>"+e+"</li>"),$("#"+s).html(r)}function n(e){var s=$("#"+e),r=$("<span class='icon-error'><i class='fi-x-circle'></i></span>");s.after(r)}}());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiZm91bmRhdGlvbiIsIndpbmRvdyIsIm9uIiwiaXMiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY2xlYXJNZXNzYWdlIiwibmFtZSIsInZhbCIsInB3ZCIsImxlbmd0aCIsIm5hbWVWZXJpZmllcyIsInRlc3QiLCJwb3N0IiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImZhaWwiLCJyZXNwb25zZVRleHQiLCJkYXRhIiwicmVzcG9uc2VKU09OIiwic2hvd01lc3NhZ2UiLCJtc2ciLCJkb25lIiwibG9jYXRpb24iLCJocmVmIiwic2hvd0Vycm9yQ2lyY2xlIiwicGF0dGVybiIsImVtYWlsIiwic3RhdHVzIiwiaGFuZGxlVmVyaWZ5VXNlciIsInVzZXIiLCJjb25maXJtUHdkIiwibmV3UHdkIiwibmV3UGFzc3dvcmQiLCJjb25maXJtcHdkIiwidWxFbGUiLCJhcHBlbmQiLCJtc2dEaXYiLCJlbXB0eSIsImlucEVsZSIsImFmdGVyIiwic3BhbkVsZSIsIm1zZ1R4dCIsImh0bWwiLCJjaXJjbGVJbnAiXSwibWFwcGluZ3MiOiJhQUFBQSxFQUFFLFdBSUFBLEVBQUVDLFVBQVVDLGFBS1pGLEVBQUVHLFFBQVFDLEdBQUcsY0FhYixXQUNtQkosRUFBQSxXQUNiQSxFQUFFLGNBQWNLLEdBQUcsWUFDckJMLEVBQUUsZUFBZU0sWUFBWSxZQUU3Qk4sRUFBRSxlQUFlTyxTQUFTLGNBakI5QlAsRUFBRSxVQUFVSSxHQUFHLFNBcUJmLFNBQXFCSSxHQUNuQkEsRUFBRUMsaUJBQ0ZDLElBQ0EsSUFBTUMsRUFBU1gsRUFBQSxhQUFhWSxNQUN0QkMsRUFBUWIsRUFBQSxpQkFBaUJZLE1BRS9CLEdBQW9CLElBQWhCRCxFQUFLRyxRQUErQixJQUFmRCxFQUFJQyxPQUFjLENBQ3pDLElBQ01DLEVBRGdCLHdCQUNhQyxLQUFLTCxHQUVwQ0ksR0FDRmYsRUFBRWlCLEtBQUssVUFDSEMs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SUFDLEtBQVNoQixTQUFUWSxHQUNJRSxFQUFGRixFQUFBRyxJQUFBLE9BQ0V6QixFQUFGLFNBQUFPLFNBQUEsUUFDRVAsRUFBQSxjQUFnQk8sWUFBbEIsWUE3UEZQLEVBQUUsVUFBQUksR0FBQSxRQUFzQk0sR0FLeEIsSUFBSXdCLEVBQU8sS0FpUVRLLFNBQU1DLElBQ054QyxFQUFFLFVBQU15QyxRQUNUekMsRUFBQSxRQUFBMEMsUUFYQzFDLEVBQUUsZ0JBQWdCTyxTQUFTLFFBYTdCUCxFQUFBLGVBQVM2QixTQUdQYyxTQUFPQyxFQUFNQyxFQUFiSixHQUNELElBQUFGLEVBQUF2QyxFQUFBLFlBM1JILElBQUF1QyxFQUFBekIsU0FpUk15QixFQUFRdkMsRUFBRSwyQkFFWnVDLEVBQU1DLE9BQU8sT0FBU00sRUFBUyxTQUMvQjlDLEVBQUUsSUFBTXlDLEdBQVFNLEtBQUtSLEdBR3ZCLFNBQVNWLEVBQWdCbUIsR0FDdkIsSUFBTUwsRUFBUzNDLEVBQUUsSUFBTWdELEdBQ2pCSCxFQUFVN0MsRUFBRSwrREFDbEIyQyxFQUFPQyxNQUFNQyxJQTFSZiIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChmdW5jdGlvbigpIHtcbiAgLyoqXG4gICAqIEluaXRpYWxpemUgZm91bmRhdGlvblxuICAgKi9cbiAgJChkb2N1bWVudCkuZm91bmRhdGlvbigpO1xuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBmdW5jdGlvbnNcbiAgICovXG4gICQod2luZG93KS5vbignbG9hZCByZXNpemUnLCBoYW5kbGVMb2FkKTtcbiAgJCgnI2xvZ2luJykub24oJ3N1Ym1pdCcsIGhhbmRsZUxvZ2luKTsgLyogb24gbG9naW4gKi9cbiAgJCgnI2VkaXRQcm9maWxlJykub24oJ3N1Ym1pdCcsIGhhbmRsZVVwZGF0ZVByb2ZpbGUpOyAvKiB1cGRhdGUgcHJvZmlsZSAqL1xuICAkKCcjY29uZmlybVVzZXInKS5vbignc3VibWl0JywgaGFuZGxlVmVyaWZ5VXNlcik7IC8qIHZlcmlmeSB1c2VyICovXG4gICQoJyNmb3Jnb3RQYXNzd29yZCcpLm9uKCdzdWJtaXQnLCBoYW5kbGVVcGRhdGVQYXNzd29yZCk7IC8qIHBvc3QgdXBkYXRlIHBhc3N3b3JkICovXG4gICQoJyNzaWdudXAnKS5vbignc3VibWl0JywgaGFuZGxlU2lnblVwKTsgLyogU2lnbiB1cCAqL1xuICAkKCcjcmVzZXQnKS5vbignY2xpY2snLCBjbGVhck1lc3NhZ2UpO1xuXG5cbiAgdmFyIHVzZXIgPSBudWxsO1xuXG5cbiAgLyogZnVuY3Rpb25zICovXG4gIGZ1bmN0aW9uIGhhbmRsZUxvYWQoKSB7XG4gICAgY29uc3QgZm9vdGVyID0gJCgnI2Zvb3RlcicpO1xuICAgIGlmICgkKCcudGl0bGUtYmFyJykuaXMoJzp2aXNpYmxlJykpIHtcbiAgICAgICQoJyNpbmRleC1tZW51JykucmVtb3ZlQ2xhc3MoJ2FkZEZsb2F0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyNpbmRleC1tZW51JykuYWRkQ2xhc3MoJ2FkZEZsb2F0Jyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlTG9naW4oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjbGVhck1lc3NhZ2UoKTtcbiAgICBjb25zdCBuYW1lID0gJCgnI3VzZXJOYW1lJykudmFsKCk7XG4gICAgY29uc3QgcHdkID0gJCgnI3VzZXJQYXNzd29yZCcpLnZhbCgpO1xuXG4gICAgaWYgKG5hbWUubGVuZ3RoICE9PSAwICYmIHB3ZC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnN0IHVzZXJOYW1lUmVnZXggPSAvXlthLXpBLVowLTkuX117MSwzMH0kLztcbiAgICAgIGNvbnN0IG5hbWVWZXJpZmllcyA9IHVzZXJOYW1lUmVnZXgudGVzdChuYW1lKTtcblxuICAgICAgaWYgKG5hbWVWZXJpZmllcykge1xuICAgICAgICAkLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBuYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHB3ZFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHRbMF0ubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3VzZXIvaG9tZSc7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcblxuICAgICAgaWYgKG5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgIGlmIChwd2QubGVuZ3RoID09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyUGFzc3dvcmQnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVVcGRhdGVQcm9maWxlKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IHVzZXJuYW1lID0gJCgnI3VzZXJOYW1lJykudmFsKCk7XG4gICAgY29uc3QgZW1haWwgPSAkKCcjZW1haWwnKS52YWwoKTtcblxuICAgIGlmICh1c2VybmFtZS5sZW5ndGggIT09IDAgJiYgZW1haWwubGVuZ3RoICE9PSAwKSB7XG5cbiAgICAgIGNvbnN0IHBhdHRlcm4gPSAvXlthLXpBLVowLTkuX117MSwzMH0kLztcbiAgICAgIGNvbnN0IG5hbWVWZXJpZmllcyA9IHBhdHRlcm4udGVzdCh1c2VybmFtZSk7XG4gICAgICBpZiAobmFtZVZlcmlmaWVzKSB7XG4gICAgICAgICQucG9zdCgnL3VzZXIvZWRpdFByb2ZpbGUnLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgICBpZiAocmVzcG9uc2VUZXh0Lmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0WzBdLm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKGRhdGEubXNnLCAnbXNnJyk7XG4gICAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgc2hvd01lc3NhZ2UoJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJywgJ2Vycm9yJyk7XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHVzZXJuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgICBpZiAoZW1haWwubGVuZ3RoID09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdlbWFpbCcpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVZlcmlmeVVzZXIoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgdXNlcm5hbWUgPSAkKCcjdXNlcm5hbWUnKS52YWwoKTtcblxuICAgIGlmICh1c2VybmFtZS5sZW5ndGggIT09IDApIHtcblxuICAgICAgJC5wb3N0KCcvdmVyaWZ5VXNlcicsIHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICQoJyN1c2VybmFtZScpLnZhbCgnJyk7XG4gICAgICAgICAgJCgnI2ZvcmdvdFBhc3N3b3JkJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjY29uZmlybVVzZXInKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgIHVzZXIgPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodXNlcm5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlcm5hbWUnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVVcGRhdGVQYXNzd29yZChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgbmV3UHdkID0gJCgnI25ld1Bhc3N3b3JkJykudmFsKCk7XG4gICAgY29uc3QgY29uZmlybVB3ZCA9ICQoJyNjb25maXJtUGFzc3dvcmQnKS52YWwoKTtcblxuICAgIGlmIChuZXdQd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ25ld1Bhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChjb25maXJtUHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZCAhPT0gbmV3UHdkKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHNob3dNZXNzYWdlKCdDb25maXJtIHBhc3N3b3JkIGRvZXNuXFwndCBtYXRjaCB3aXRoIHRoZSBuZXcgcGFzc3dvcmQnLCAnZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkLmxlbmd0aCAhPT0gMCAmJiBuZXdQd2QgPT09IGNvbmZpcm1Qd2QpIHtcbiAgICAgICQucG9zdCgnL2ZvcmdvdFBhc3N3b3JkJywge1xuICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdQd2QsXG4gICAgICAgICAgdXNlcjogdXNlclxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YS5tc2csICdtc2cnKTtcbiAgICAgICAgICAkKCcuYnRucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgJCgnI2xvZ2luTGluaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVNpZ25VcChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgbmFtZSA9ICQoXCIjdXNlck5hbWVcIikudmFsKCk7XG4gICAgY29uc3QgZW1haWwgPSAkKFwiI3VzZXJFbWFpbFwiKS52YWwoKTtcbiAgICBjb25zdCBwd2QgPSAkKFwiI3VzZXJQYXNzd29yZFwiKS52YWwoKTtcbiAgICBjb25zdCBjb25maXJtcHdkID0gJChcIiNjb25maXJtUGFzc3dvcmRcIikudmFsKCk7XG5cbiAgICBpZiAobmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKGVtYWlsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyRW1haWwnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKHB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlclBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChjb25maXJtcHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKHB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZCAhPT0gcHdkKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHNob3dFcnJvcignQ29uZmlybSBwYXNzd29yZCBkb2VzblxcJ3QgbWF0Y2ggd2l0aCBwYXNzd29yZCcsICdlcnJvcicpO1xuICAgIH1cblxuICAgIC8vIGNvbnN0IGVycm9yID0gJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJztcbiAgICAvLyBjb25zdCBuYW1lID0gJ09MSVZFJztcbiAgICAvLyBjb25zdCBwd2QgPSAnT0xJVkUnO1xuICAgIC8vIGNvbnN0IGVtYWlsID0gJ2dlZXRhQGdtYWlsLmNvbSc7XG4gICAgaWYgKG5hbWUubGVuZ3RoICE9PSAwICYmIHB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZC5sZW5ndGggIT09IDAgJiYgZW1haWwubGVuZ3RoICE9PSAwKSB7XG4gICAgICAkLnBvc3QoJy9zaWdudXAnLCB7XG4gICAgICAgICAgdXNlcm5hbWU6IG5hbWUsXG4gICAgICAgICAgcGFzc3dvcmQ6IHB3ZCxcbiAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZVRleHQubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0WzBdLm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBzaG93TWVzc2FnZShkYXRhLm1zZywgJ21zZycpO1xuICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFV0aWxpdHkgZnVuY3Rpb25zXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNsZWFyTWVzc2FnZSgpIHtcbiAgICAkKCcjZXJyb3InKS5lbXB0eSgpO1xuICAgICQoJyNtc2cnKS5lbXB0eSgpO1xuICAgICQoJyNlbXB0eUZpZWxkcycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLmljb24tZXJyb3InKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1zZ1R4dCwgbXNnRGl2KSB7XG4gICAgdmFyIHVsRWxlID0gJCgnI21zZ2NvbnQnKTtcbiAgICBpZiAodWxFbGUubGVuZ3RoID09PSAwKSB7XG4gICAgICB1bEVsZSA9ICQoJzx1bCBpZD1cXCdtc2djb250XFwnPjwvdWw+Jyk7XG4gICAgfVxuICAgIHVsRWxlLmFwcGVuZCgnPGxpPicgKyBtc2dUeHQgKyAnPC9saT4nKTtcbiAgICAkKCcjJyArIG1zZ0RpdikuaHRtbCh1bEVsZSk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93RXJyb3JDaXJjbGUoY2lyY2xlSW5wKSB7XG4gICAgY29uc3QgaW5wRWxlID0gJCgnIycgKyBjaXJjbGVJbnApO1xuICAgIGNvbnN0IHNwYW5FbGUgPSAkKCc8c3BhbiBjbGFzcz1cXCdpY29uLWVycm9yXFwnPjxpIGNsYXNzPVxcJ2ZpLXgtY2lyY2xlXFwnPjwvaT48L3NwYW4+Jyk7XG4gICAgaW5wRWxlLmFmdGVyKHNwYW5FbGUpO1xuICB9XG5cblxuXG5cbn0oKSk7XG4iXX0=
