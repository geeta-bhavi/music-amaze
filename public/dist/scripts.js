"use strict";$(function(){var e=null;function s(){0===$("li.trackList.highlight").prev().length?$("#trackPrev").addClass("inactive"):$("#trackPrev").removeClass("inactive"),0===$("li.trackList.highlight").next().length?$("#trackNext").addClass("inactive"):$("#trackNext").removeClass("inactive"),0===$("li.trackList.highlight").prev().length&&0===$("li.trackList.highlight").next().length&&$("#trackShuffle").addClass("inactive")}$(document).foundation(),$(".screenText").slick({dots:!0,infinite:!0,speed:500,fade:!0,cssEase:"linear"}),window.location.pathname.indexOf("play")&&$("#audioPlayer").mediaelementplayer({stretching:"responsive",pluginPath:"../js/lib/build/",success:function(a,t,r){e=a,s(),e.play(),$(a).on("ended",function(){if($("#trackShuffle").hasClass("active")){var t=$("li.trackList").length,r=Math.floor(Math.random()*t+1);(n=$("li.trackList:nth-child("+r+")")).hasClass("highlight")&&0===(n=n.next()).length&&(n=$("li.trackList:nth-child(1)")),n.click(),s()}else{var n=$("li.trackList.highlight").next();$("#trackRepeat").hasClass("active")?a.play():0===n.length?function(s){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),s.addClass("highlight"),s.find(".trackItem").addClass("fi-sound");var a=s.data("track-src");e.setSrc(a),e.load()}($("li.trackList").first()):n.click(),s()}})},error:function(e,s){alert("There is some error at the server playing the track!")}}),$(window).on("load resize",function(){$("#footer");$(".title-bar").is(":visible")?$("#index-menu").removeClass("addFloat"):$("#index-menu").addClass("addFloat");$(window).width()<400?($(".menuDiv").addClass("menuMode"),$("#user-menu").addClass("menuMod"),$("#user-menu").removeClass("show")):($("#user-menu").removeClass("show"),$("#user-menu").css("width","180px"),$(".close-icon").remove(),$(".menuDiv").removeClass("menuMode"),$("#user-menu").removeClass("menuMod"))}),$("#login").on("submit",function(e){e.preventDefault(),l();var s=$("#userName").val(),a=$("#userPassword").val();if(0!==s.length&&0!==a.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(s);t?$.post("/login",{username:s,password:a}).fail(function(e){var s=e.responseJSON;400===e.status&&c(s[0].msg,"error"),401===e.status&&c(s.msg,"error")}).done(function(e){window.location.href="/user/home"}):(d("userName"),c("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(d("userName"),$("#emptyFields").removeClass("hide")),0==a.length&&(d("userPassword"),$("#emptyFields").removeClass("hide"))}),$("#editProfile").on("submit",function(e){e.preventDefault(),l();var s=$("#userName").val(),a=$("#email").val();if(0!==s.length&&0!==a.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(s);t?$.post("/user/editProfile",{username:s,email:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?c(s[0].msg,"error"):c(s.msg,"error")}}).done(function(e){c(e.msg,"msg"),$("#loginLink").removeClass("hide"),$(".btns").addClass("hide")}):(d("userName"),c("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(d("userName"),$("#emptyFields").removeClass("hide")),0==a.length&&(d("email"),$("#emptyFields").removeClass("hide"))}),$("#confirmUser").on("submit",function(e){e.preventDefault(),l();var s=$("#username").val();0!==s.length?$.post("/verifyUser",{username:s}).fail(function(e){if(401===e.status){var s=e.responseJSON;c(s.msg,"error")}}).done(function(e){$("#username").val(""),$("#forgotPassword").removeClass("hide"),$("#confirmUser").addClass("hide"),a=e}):0===s.length&&(d("username"),$("#emptyFields").removeClass("hide"))}),$("#forgotPassword").on("submit",function(e){e.preventDefault(),l();var s=$("#newPassword").val(),t=$("#confirmPassword").val();0===s.length&&(d("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(d("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==s.length&&t!==s&&(d("confirmPassword"),$("#emptyFields").addClass("hide"),c("Confirm password doesn't match with the new password","error"));0!==s.length&&0!==t.length&&s===t&&$.post("/forgotPassword",{newPassword:s,user:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;c(s.msg,"error")}}).done(function(e){c(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#signup").on("submit",function(e){e.preventDefault(),l();var s=$("#userName").val(),a=$("#userEmail").val(),t=$("#userPassword").val(),r=$("#confirmPassword").val(),n=/^[a-zA-Z0-9._]{1,30}$/.test(s);0===s.length&&(d("userName"),$("#emptyFields").removeClass("hide"));n||0===s.length||(d("userName"),c("Usernames can only use letters, numbers, underscores and periods.","error"));0===a.length&&(d("userEmail"),$("#emptyFields").removeClass("hide"));0===t.length&&(d("userPassword"),$("#emptyFields").removeClass("hide"));0===r.length&&(d("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==t.length&&0!==r.length&&r!==t&&(d("confirmPassword"),$("#emptyFields").addClass("hide"),c("Confirm password doesn't match with password","error"),0!==a.length&&0!==s.length||$("#emptyFields").removeClass("hide"));0!==s.length&&0!==t.length&&0!==r.length&&0!==a.length&&t===r&&n&&$.post("/signup",{username:s,password:t,email:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?c(s[0].msg,"error"):c(s.msg,"error")}}).done(function(e){c(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#reset").on("click",l),$("#changePassword").on("submit",function(e){e.preventDefault(),l();var s=$("#oldPassword").val(),a=$("#newPassword").val(),t=$("#confirmPassword").val();0===s.length&&(d("oldPassword"),$("#emptyFields").removeClass("hide"));0===a.length&&(d("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(d("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==a.length&&0!==t.length&&t!==a&&(d("confirmPassword"),$("#emptyFields").addClass("hide"),c("Confirm password doesn't match with the new password","error"),0===s.length&&$("#emptyFields").removeClass("hide"));0!==s.length&&0!==a.length&&0!==t.length&&a===t&&$.post("/user/changePassword",{oldPassword:s,newPassword:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;c(s.msg,"error")}}).done(function(e){c(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#searchIcon").on("click",t),$(".js-search-close").on("click",function(e){e.preventDefault(),$("#search-text").val(""),$("#headerDiv").removeClass("hide").addClass("show"),$("#search").removeClass("show"),$(".js-nonSearchView").removeClass("hide"),$(".js-searchView").addClass("hide"),-1===window.location.pathname.indexOf("user")&&(window.location.pathname="/user/home")}),$(".menuDiv").on("click",function(e){e.preventDefault(),$("#user-menu").hasClass("show")?$("#user-menu").removeClass("show"):$("#user-menu").addClass("show")}),$(".trackList").on("click",function(s){if(!$(this).hasClass("highlight")){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),$(this).addClass("highlight"),$(this).find(".trackItem").addClass("fi-sound");var a=$(this).data("track-src");e.setSrc(a),e.load(),e.play()}}),$("#search-text").on("keyup",function(e){13===e.keyCode&&r(e)}),$(".js-search-icon").on("click",r),$("#trackRepeat").on("click",o),$("#trackLike").on("click",o),$("#trackPrev").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||($("li.trackList.highlight").prev().click(),s())}),$("#trackNext").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||($("li.trackList.highlight").next().click(),s())}),$("#trackShuffle").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||$(this).toggleClass("active")}),$(".playListCreate").on("click",function(e){e.preventDefault()}),$(document).on("click",".menuMode",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").addClass("show"),s.css("width","250px"),s.prepend('<div class="close-icon"><i class="fi-x"></i></div>')}),$(document).on("click",".close-icon",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").removeClass("show"),s.css("width","180px"),$(".close-icon").remove()}),$(document).on("click",".seeAllR",i);var a=null;function t(e){e&&e.preventDefault(),$("#headerDiv").removeClass("show").addClass("hide"),$("#search").addClass("show"),$(".js-nonSearchView").addClass("hide"),$(".js-searchView").removeClass("hide")}function r(e,s,a){null!==e&&e.preventDefault(),$(".js-searchView").empty();var t=void 0!==s?s:$.trim($("#search-text").val());(t=t.replace(/\s+/g," ")).length>0&&" "!==t&&$.post("/search/"+t).fail(function(e){console.log(e),$("#searchCont").html(e)}).done(function(e){if($("#searchCont").html(e),$("#js-searchResults").removeClass("hide"),void 0===a){var s="/search/"+t;history.pushState({search:t},"",s)}})}if(console.log(window.history.state),console.log(window.history),null!==window.history.state){var n=window.history.state;void 0!==n.search&&void 0===n.category?(t(),$("#search-text").val(n.search),r(null,n.search,"noPopstate")):void 0!==n.search&&void 0!==n.category&&(t(),$("#search-text").val(n.search),i(null,n.search,n.category,"noPopstate"))}function i(e,s,a,t){null!==e&&e.preventDefault();var r=void 0!==s?s:$(".searchStr").html(),n=void 0!==a?a:$(this).data("category");$.post("/search/"+n+"/"+r).fail(function(e){$("#searchCont").html(e)}).done(function(e){if($("#searchCont").html(e),$("#js-searchResults").removeClass("hide"),void 0===t){var s="/search/"+n+"/"+r;history.pushState({search:r,category:n},"",s)}})}function o(e){e.preventDefault(),$(this).toggleClass("active")}function l(){$("#error").empty(),$("#msg").empty(),$("#emptyFields").addClass("hide"),$(".icon-error").remove()}function c(e,s){var a=$("#msgcont");0===a.length&&(a=$("<ul id='msgcont'></ul>")),a.append("<li>"+e+"</li>"),$("#"+s).html(a)}function d(e){var s=$("#"+e),a=$("<span class='icon-error'><i class='fi-x-circle'></i></span>");s.after(a)}$(window).on("popstate",function(e){var s=e.originalEvent.state;if(null===s){var a=window.location.href;window.location.href=a}else void 0!==s.search&&void 0===s.category?(t(e),$("#search-text").val(s.search),r(e,s.search,"noPopstate")):void 0!==s.search&&void 0!==s.category&&(t(e),$("#search-text").val(s.search),i(e,s.search,s.category,"noPopstate"))})}());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsIm1lZGlhRWxlIiwiaGlnaExpZ2h0UHJldk5leHQiLCJwcmV2IiwibGVuZ3RoIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsIm5leHQiLCJkb2N1bWVudCIsImZvdW5kYXRpb24iLCJzbGljayIsImRvdHMiLCJpbmZpbml0ZSIsInNwZWVkIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsImluZGV4T2YiLCJtZWRpYWVsZW1lbnRwbGF5ZXIiLCJwbHVnaW5QYXRoIiwic3VjY2VzcyIsIm1lZGlhRWxlbWVudCIsIm9yaWdpbmFsTm9kZSIsImluc3RhbmNlIiwib24iLCJoYXNDbGFzcyIsInJhbmRvbSIsIk1hdGgiLCJmbG9vciIsImxpQ291bnQiLCJsaUVsZSIsImNsaWNrIiwicGxheSIsImZpbmQiLCJ0cmFja1NyYyIsImRhdGEiLCJsb2FkIiwiY2FsbEZvY3VzIiwiZmlyc3QiLCJlcnJvciIsImFsZXJ0Iiwid2lkdGgiLCJjc3MiLCJyZW1vdmUiLCJlIiwicHJldmVudERlZmF1bHQiLCJjbGVhck1lc3NhZ2UiLCJuYW1lIiwicHdkIiwidXNlck5hbWVSZWdleCIsInZhbCIsInBvc3QiLCJ0ZXN0IiwicGFzc3dvcmQiLCJ1c2VybmFtZSIsInJlc3BvbnNlVGV4dCIsInN0YXR1cyIsImZhaWwiLCJyZXNwb25zZUpTT04iLCJzaG93TWVzc2FnZSIsIm1zZyIsImhyZWYiLCJzaG93RXJyb3JDaXJjbGUiLCJoYW5kbGVVcGRhdGVQcm9maWxlIiwibmFtZVZlcmlmaWVzIiwiZW1haWwiLCJkb25lIiwiaGFuZGxlVmVyaWZ5VXNlciIsImhhbmRsZVVwZGF0ZVBhc3N3b3JkIiwiY29uZmlybVB3ZCIsIm5ld1B3ZCIsIm5ld1Bhc3N3b3JkIiwidXNlciIsImhhbmRsZUNoYW5nZVBhc3N3b3JkIiwib2xkUHdkIiwiY29uZmlybXB3ZCIsImRpc3BsYXlTZWFyY2hCYXIiLCJvbGRQYXNzd29yZCIsInNob3dVc2VyTWVudSIsInVzZXJJY29uIiwiaGlkZVVzZXJNZW51IiwiY2hhbmdlVHJhY2siLCJ0aGlzIiwic2V0U3JjIiwia2V5Q29kZSIsInNlYXJjaCIsImxpbmtBY3RpdmUiLCJwbGF5UHJldmlvdXMiLCJ0b2dnbGVDbGFzcyIsInNlZUFsbFJlc3VsdHMiLCJzaG93VXNlck1lbnVEIiwiY29uc29sZSIsImxvZyIsImhpc3RvcnkiLCJlbXB0eSIsInNlYXJjaFN0cmluZyIsInN0YXRlIiwiaHRtbCIsInVuZGVmaW5lZCIsInBvcHN0YXRlIiwic3RyIiwicHVzaFN0YXRlIiwib3JpZ2luYWxFdmVudCIsImNhdGVnb3J5Iiwic3JjaFN0ciIsImNhdGVncnkiLCJjcmVhdGVQbGF5bGlzdCIsInNlYXJjaFN0ciIsIm1zZ0RpdiIsInVsRWxlIiwic3BhbkVsZSIsIm1zZ1R4dCIsImFwcGVuZCIsImNpcmNsZUlucCIsImlucEVsZSIsImFmdGVyIiwicGF0aCJdLCJtYXBwaW5ncyI6ImFBQUFBLEVBQUUsV0FBQSxJQUFBQyxFQUFXLEtBMEdULFNBQU1DLElBQ0osSUFBRUYsRUFBQSwwQkFBdUJHLE9BQXpCQyxPQURGSixFQUFBLGNBRU9LLFNBQUEsWUFFTkwsRUFBQSxjQUFBTSxZQUFBLFlBRUMsSUFBRU4sRUFBQSwwQkFBdUJPLE9BQXpCSCxPQURGSixFQUFBLGNBRU9LLFNBQUEsWUFFTkwsRUFBQSxjQUFBTSxZQUFBLFlBR0MsSUFBRU4sRUFBQSwwQkFBMEJHLE9BQUFDLFFBQTVCLElBQUFKLEVBQUEsMEJBQUFPLE9BQUFILFFBQ0RKLEVBQUEsaUJBQUFLLFNBQUEsWUFoSEhMLEVBQUVRLFVBQVVDLGFBS1pULEVBQUUsZUFBZVUsT0FDZkMsTUFBTSxFQUROQyxVQUFBLEVBQ0FELE1BQU0sSUFDTkMsTUFBQUEsRUFDQUMsUUFBTyxXQVFMQyxPQUFPQyxTQUFTQyxTQUFTQyxRQUFRLFNBQ25DakIsRUFBRSxnQkFBZ0JrQixvQkFEaEJKLFdBQU9DLGFBQ1BJLFdBQUEsbUJBR0FDLFFBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FD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RkUsU0FBVU4sR0FDWCxHQUFBSCxNQUtILFNBQVN0QyxFQUFBQSxHQUNQbEIsRUFBQUMsaUJBQ0E3QyxFQUFBa0YsTUFBTTRCLFlBQVksVUFsQnBCLFNBQVNoRSxJQUNQOUMsRUFBRSxVQUFVOEYsUUFDWjlGLEVBQUUsUUFBUThGLFFBQ1Y5RixFQUFFLGdCQUFnQkssU0FBUyxRQUMzQkwsRUFBRSxlQUFlMkMsU0FHbkIsU0FBU2dCLEVBQVlvRCxFQUFRSCxHQUMzQixJQUFJQyxFQUFRN0csRUFBRSxZQUNPLElBQWpCNkcsRUFBTXpHLFNBQ1J5RyxFQUFRN0csRUFBRSwyQkFFWjZHLEVBQU1HLE9BQU8sT0FBU0QsRUFBUyxTQUMvQi9HLEVBQUUsSUFBTTRHLEdBQVFYLEtBQUtZLEdBR3ZCLFNBQVMvQyxFQUFnQm1ELEdBQ3ZCLElBQU1DLEVBQVNsSCxFQUFFLElBQU1pSCxHQUNqQkgsRUFBVTlHLEVBQUUsK0RBQ2xCa0gsRUFBT0MsTUFBTUwsR0E5Q1Y5RyxFQUFBYyxRQUNLVSxHQUFBLFdBQUEsU0FBZW9CLEdBQ25CNUMsSUFBRWdHLEVBQUFwRCxFQUFBMEQsY0FBRk4sTUFFQSxHQUFJRyxPQUFKSCxFQUFpQkUsQ0FDZixJQUFNRSxFQUFBQSxPQUFBQSxTQUFpQkcsS0FDdkJWLE9BQUFBLFNBQVFRLEtBQVVlLFlBQUFsQixJQUNoQmIsRUFBUXNCLGFBRFFULElBQUFGLEVBQUFPLFVBRWhCQSxFQUFVQSxHQUZNdkcsRUFBQSxnQkFBbEJrRCxJQUFBOEMsRUFBQVgsUUFJREEsRUFBQXpDLEVBQUFvRCxFQUFBWCxPQUFBLG9CQWJMYSxJQUFBRixFQUFBWCxhQUFBYSxJQUFBRixFQUFBTyxXQWVEM0IsRUFBQWhDLEdBNUJHNUMsRUFBRSxnQkFBZ0JrRCxJQUFJOEMsRUFBTVgsUUE4QmhDSSxFQUFTSCxFQUFUVSxFQUF1QlgsT0FBQVcsRUFBQU8sU0FBQSxpQkFyckJ2QiIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChmdW5jdGlvbigpIHtcblxuICB2YXIgbWVkaWFFbGUgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGZvdW5kYXRpb25cbiAgICovXG4gICQoZG9jdW1lbnQpLmZvdW5kYXRpb24oKTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBzbGlkZXJcbiAgICovXG4gICQoJy5zY3JlZW5UZXh0Jykuc2xpY2soe1xuICAgIGRvdHM6IHRydWUsXG4gICAgaW5maW5pdGU6IHRydWUsXG4gICAgc3BlZWQ6IDUwMCxcbiAgICBmYWRlOiB0cnVlLFxuICAgIGNzc0Vhc2U6ICdsaW5lYXInXG4gIH0pO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGF1ZGlvIHBsYXllclxuICAgKi9cbiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCdwbGF5JykpIHtcbiAgICAkKCcjYXVkaW9QbGF5ZXInKS5tZWRpYWVsZW1lbnRwbGF5ZXIoe1xuICAgICAgc3RyZXRjaGluZzogJ3Jlc3BvbnNpdmUnLFxuICAgICAgcGx1Z2luUGF0aDogJy4uL2pzL2xpYi9idWlsZC8nLFxuICAgICAgLy8gV2hlbiB1c2luZyBqUXVlcnkncyBgbWVkaWFlbGVtZW50cGxheWVyYCwgYW4gYGluc3RhbmNlYCBhcmd1bWVudFxuICAgICAgLy8gaXMgYXZhaWxhYmxlIGluIHRoZSBgc3VjY2Vzc2AgY2FsbGJhY2tcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKG1lZGlhRWxlbWVudCwgb3JpZ2luYWxOb2RlLCBpbnN0YW5jZSkge1xuICAgICAgICBtZWRpYUVsZSA9IG1lZGlhRWxlbWVudDtcbiAgICAgICAgaGlnaExpZ2h0UHJldk5leHQoKTtcblxuICAgICAgICBtZWRpYUVsZS5wbGF5KCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coMSk7XG4gICAgICAgICQobWVkaWFFbGVtZW50KS5vbignZW5kZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoJCgnI3RyYWNrU2h1ZmZsZScpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgY29uc3QgbGlDb3VudCA9ICQoJ2xpLnRyYWNrTGlzdCcpLmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbSA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiBsaUNvdW50KSArIDEpO1xuICAgICAgICAgICAgdmFyIGxpRWxlID0gJCgnbGkudHJhY2tMaXN0Om50aC1jaGlsZCgnICsgcmFuZG9tICsgJyknKTtcblxuXG4gICAgICAgICAgICBpZiAobGlFbGUuaGFzQ2xhc3MoJ2hpZ2hsaWdodCcpKSB7XG4gICAgICAgICAgICAgIGxpRWxlID0gbGlFbGUubmV4dCgpO1xuICAgICAgICAgICAgICBpZiAobGlFbGUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgbGlFbGUgPSAkKCdsaS50cmFja0xpc3Q6bnRoLWNoaWxkKDEpJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGlFbGUuY2xpY2soKTtcbiAgICAgICAgICAgIGhpZ2hMaWdodFByZXZOZXh0KCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygxKTtcblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbGlFbGUgPSAkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykubmV4dCgpO1xuICAgICAgICAgICAgaWYgKCQoJyN0cmFja1JlcGVhdCcpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgICBtZWRpYUVsZW1lbnQucGxheSgpO1xuICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChsaUVsZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjYWxsRm9jdXMoJCgnbGkudHJhY2tMaXN0JykuZmlyc3QoKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGlFbGUuY2xpY2soKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGlnaExpZ2h0UHJldk5leHQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihtZWRpYUVsZW1lbnQsIG9yaWdpbmFsTm9kZSkge1xuICAgICAgICBhbGVydCgnVGhlcmUgaXMgc29tZSBlcnJvciBhdCB0aGUgc2VydmVyIHBsYXlpbmcgdGhlIHRyYWNrIScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlTm9PZlBsYXlzKHRyYWNrSWQpIHtcbiAgICAkLnBvc3QoJycpXG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHNodWZmbGVUcmFja3MoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2luYWN0aXZlJykpIHtcbiAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXlQcmV2aW91cyhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnaW5hY3RpdmUnKSkge1xuICAgICAgdmFyIGxpRWxlID0gJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLnByZXYoKTtcbiAgICAgIGxpRWxlLmNsaWNrKCk7XG4gICAgICBoaWdoTGlnaHRQcmV2TmV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXlOZXh0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdpbmFjdGl2ZScpKSB7XG4gICAgICB2YXIgbGlFbGUgPSAkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykubmV4dCgpO1xuICAgICAgbGlFbGUuY2xpY2soKTtcbiAgICAgIGhpZ2hMaWdodFByZXZOZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGlnaExpZ2h0UHJldk5leHQoKSB7XG4gICAgaWYgKCQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5wcmV2KCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAkKCcjdHJhY2tQcmV2JykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyN0cmFja1ByZXYnKS5yZW1vdmVDbGFzcygnaW5hY3RpdmUnKTtcbiAgICB9XG4gICAgaWYgKCQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5uZXh0KCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAkKCcjdHJhY2tOZXh0JykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyN0cmFja05leHQnKS5yZW1vdmVDbGFzcygnaW5hY3RpdmUnKTtcbiAgICB9XG5cbiAgICBpZiAoJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLnByZXYoKS5sZW5ndGggPT09IDAgJiYgJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLm5leHQoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICQoJyN0cmFja1NodWZmbGUnKS5hZGRDbGFzcygnaW5hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjYWxsRm9jdXMobGlFbGUpIHtcbiAgICAkKCcudHJhY2tMaXN0JykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICQoJy50cmFja0l0ZW0nKS5yZW1vdmVDbGFzcygnZmktc291bmQnKTtcbiAgICBsaUVsZS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgbGlFbGUuZmluZCgnLnRyYWNrSXRlbScpLmFkZENsYXNzKCdmaS1zb3VuZCcpO1xuICAgIGNvbnN0IHRyYWNrU3JjID0gbGlFbGUuZGF0YSgndHJhY2stc3JjJyk7XG4gICAgLy8gY29uc3Qgc3RyID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuICAgIC8vIGNvbnN0IHBhdGggPSBzdHIuc3Vic3RyKDAsIHN0ci5sYXN0SW5kZXhPZihcIi9cIikgKyAxKTtcbiAgICAvLyBjb25zdCB0cmFja0lkID0gbGlFbGUuYXR0cignaWQnKTtcbiAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAgIG1lZGlhRWxlLmxvYWQoKTtcbiAgICAvL2hpc3RvcnkucHVzaFN0YXRlKHRyYWNrSWQsICcnLCBwYXRoICsgdHJhY2tJZCk7XG4gICAgLy8gJChtZWRpYUVsZSkub24oJ3BsYXlpbmcnLCAoKSA9PiB7XG4gICAgLy8gICBjb25zb2xlLmxvZygxKTtcbiAgICAvLyAgICQobWVkaWFFbGUpLm9mZigncGxheWluZycpO1xuICAgIC8vIH0pXG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgZnVuY3Rpb25zXG4gICAqL1xuICAkKHdpbmRvdykub24oJ2xvYWQgcmVzaXplJywgaGFuZGxlTG9hZCk7XG4gICQoJyNsb2dpbicpLm9uKCdzdWJtaXQnLCBoYW5kbGVMb2dpbik7IC8qIG9uIGxvZ2luICovXG4gICQoJyNlZGl0UHJvZmlsZScpLm9uKCdzdWJtaXQnLCBoYW5kbGVVcGRhdGVQcm9maWxlKTsgLyogdXBkYXRlIHByb2ZpbGUgKi9cbiAgJCgnI2NvbmZpcm1Vc2VyJykub24oJ3N1Ym1pdCcsIGhhbmRsZVZlcmlmeVVzZXIpOyAvKiB2ZXJpZnkgdXNlciAqL1xuICAkKCcjZm9yZ290UGFzc3dvcmQnKS5vbignc3VibWl0JywgaGFuZGxlVXBkYXRlUGFzc3dvcmQpOyAvKiBwb3N0IHVwZGF0ZSBwYXNzd29yZCAqL1xuICAkKCcjc2lnbnVwJykub24oJ3N1Ym1pdCcsIGhhbmRsZVNpZ25VcCk7IC8qIFNpZ24gdXAgKi9cbiAgJCgnI3Jlc2V0Jykub24oJ2NsaWNrJywgY2xlYXJNZXNzYWdlKTsgLyogQ2xlYXIgbWVzc2FnZXMgb24gY2xpY2sgb2YgcmVzZXQgKi9cbiAgJCgnI2NoYW5nZVBhc3N3b3JkJykub24oJ3N1Ym1pdCcsIGhhbmRsZUNoYW5nZVBhc3N3b3JkKTsgLyogcG9zdCBjaGFuZ2UgcGFzc3dvcmQgKi9cbiAgJCgnI3NlYXJjaEljb24nKS5vbignY2xpY2snLCBkaXNwbGF5U2VhcmNoQmFyKTtcbiAgJCgnLmpzLXNlYXJjaC1jbG9zZScpLm9uKCdjbGljaycsIGhpZGVTZWFyY2hCYXIpO1xuICAkKCcubWVudURpdicpLm9uKCdjbGljaycsIHNob3dVc2VyTWVudUQpO1xuICAkKCcudHJhY2tMaXN0Jykub24oJ2NsaWNrJywgY2hhbmdlVHJhY2spOyAvKiBjaGFuZ2UgdHJhY2sgb24gY2xpY2sgKi9cbiAgJCgnI3NlYXJjaC10ZXh0Jykub24oJ2tleXVwJywgY2FsbFNlYXJjaCk7IC8qIHNlYXJjaCBmdW5jdGlvbmFsaXR5ICovXG4gICQoJy5qcy1zZWFyY2gtaWNvbicpLm9uKCdjbGljaycsIHNlYXJjaCk7IC8qIHNlYXJjaCBmdW5jdGlvbmFsaXR5ICovXG4gICQoJyN0cmFja1JlcGVhdCcpLm9uKCdjbGljaycsIGxpbmtBY3RpdmUpO1xuICAkKCcjdHJhY2tMaWtlJykub24oJ2NsaWNrJywgbGlua0FjdGl2ZSk7XG4gICQoJyN0cmFja1ByZXYnKS5vbignY2xpY2snLCBwbGF5UHJldmlvdXMpOyAvKiBwbGF5IHByZXZpb3VzIHRyYWNrICovXG4gICQoJyN0cmFja05leHQnKS5vbignY2xpY2snLCBwbGF5TmV4dCk7IC8qIHBsYXkgbmV4dCB0cmFjayAqL1xuICAkKCcjdHJhY2tTaHVmZmxlJykub24oJ2NsaWNrJywgc2h1ZmZsZVRyYWNrcyk7IC8qIHNodWZmbGUgdHJhY2tzKi9cbiAgJCgnLnBsYXlMaXN0Q3JlYXRlJykub24oJ2NsaWNrJywgY3JlYXRlUGxheWxpc3QpOyAvKiBDcmVhdGUgcGxheWxpc3QgKi9cbiAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5tZW51TW9kZScsIHNob3dVc2VyTWVudSk7XG4gICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtaWNvbicsIGhpZGVVc2VyTWVudSk7XG4gICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2VlQWxsUicsIHNlZUFsbFJlc3VsdHMpOyAvKiBzZWUgYWxsIHRoZSB0cmFja3Mgb2Ygc2VhcmNoIHJlc3VsdHMgKi9cblxuXG4gIHZhciB1c2VyID0gbnVsbDtcblxuXG4gIC8qIGZ1bmN0aW9ucyAqL1xuICBmdW5jdGlvbiBoYW5kbGVMb2FkKCkge1xuICAgIGNvbnN0IGZvb3RlciA9ICQoJyNmb290ZXInKTtcbiAgICBpZiAoJCgnLnRpdGxlLWJhcicpLmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAkKCcjaW5kZXgtbWVudScpLnJlbW92ZUNsYXNzKCdhZGRGbG9hdCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjaW5kZXgtbWVudScpLmFkZENsYXNzKCdhZGRGbG9hdCcpO1xuICAgIH1cbiAgICB2YXIgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcbiAgICBpZiAod2lkdGggPCA0MDApIHtcbiAgICAgICQoJy5tZW51RGl2JykuYWRkQ2xhc3MoJ21lbnVNb2RlJyk7XG4gICAgICAkKCcjdXNlci1tZW51JykuYWRkQ2xhc3MoJ21lbnVNb2QnKTtcbiAgICAgICQoJyN1c2VyLW1lbnUnKS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICQoJyN1c2VyLW1lbnUnKS5jc3MoJ3dpZHRoJywgJzE4MHB4Jyk7XG4gICAgICAkKCcuY2xvc2UtaWNvbicpLnJlbW92ZSgpO1xuICAgICAgJCgnLm1lbnVEaXYnKS5yZW1vdmVDbGFzcygnbWVudU1vZGUnKTtcbiAgICAgICQoJyN1c2VyLW1lbnUnKS5yZW1vdmVDbGFzcygnbWVudU1vZCcpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUxvZ2luKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY2xlYXJNZXNzYWdlKCk7XG4gICAgY29uc3QgbmFtZSA9ICQoJyN1c2VyTmFtZScpLnZhbCgpO1xuICAgIGNvbnN0IHB3ZCA9ICQoJyN1c2VyUGFzc3dvcmQnKS52YWwoKTtcblxuICAgIGlmIChuYW1lLmxlbmd0aCAhPT0gMCAmJiBwd2QubGVuZ3RoICE9PSAwKSB7XG4gICAgICBjb25zdCB1c2VyTmFtZVJlZ2V4ID0gL15bYS16QS1aMC05Ll9dezEsMzB9JC87XG4gICAgICBjb25zdCBuYW1lVmVyaWZpZXMgPSB1c2VyTmFtZVJlZ2V4LnRlc3QobmFtZSk7XG5cbiAgICAgIGlmIChuYW1lVmVyaWZpZXMpIHtcbiAgICAgICAgJC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogbmFtZSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiBwd2RcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0WzBdLm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy91c2VyL2hvbWUnO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgICBzaG93TWVzc2FnZSgnVXNlcm5hbWVzIGNhbiBvbmx5IHVzZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyBhbmQgcGVyaW9kcy4nLCAnZXJyb3InKTtcblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG5cbiAgICAgIGlmIChuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgICBpZiAocHdkLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlclBhc3N3b3JkJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlVXBkYXRlUHJvZmlsZShlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY2xlYXJNZXNzYWdlKCk7XG5cbiAgICBjb25zdCB1c2VybmFtZSA9ICQoJyN1c2VyTmFtZScpLnZhbCgpO1xuICAgIGNvbnN0IGVtYWlsID0gJCgnI2VtYWlsJykudmFsKCk7XG5cbiAgICBpZiAodXNlcm5hbWUubGVuZ3RoICE9PSAwICYmIGVtYWlsLmxlbmd0aCAhPT0gMCkge1xuXG4gICAgICBjb25zdCBwYXR0ZXJuID0gL15bYS16QS1aMC05Ll9dezEsMzB9JC87XG4gICAgICBjb25zdCBuYW1lVmVyaWZpZXMgPSBwYXR0ZXJuLnRlc3QodXNlcm5hbWUpO1xuICAgICAgaWYgKG5hbWVWZXJpZmllcykge1xuICAgICAgICAkLnBvc3QoJy91c2VyL2VkaXRQcm9maWxlJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlVGV4dC5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dFswXS5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBzaG93TWVzc2FnZShkYXRhLm1zZywgJ21zZycpO1xuICAgICAgICAgICAgJCgnI2xvZ2luTGluaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICAkKCcuYnRucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAgIHNob3dNZXNzYWdlKCdVc2VybmFtZXMgY2FuIG9ubHkgdXNlIGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzIGFuZCBwZXJpb2RzLicsICdlcnJvcicpO1xuXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh1c2VybmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgICAgaWYgKGVtYWlsLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgnZW1haWwnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVWZXJpZnlVc2VyKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IHVzZXJuYW1lID0gJCgnI3VzZXJuYW1lJykudmFsKCk7XG5cbiAgICBpZiAodXNlcm5hbWUubGVuZ3RoICE9PSAwKSB7XG5cbiAgICAgICQucG9zdCgnL3ZlcmlmeVVzZXInLCB7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAkKCcjdXNlcm5hbWUnKS52YWwoJycpO1xuICAgICAgICAgICQoJyNmb3Jnb3RQYXNzd29yZCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgJCgnI2NvbmZpcm1Vc2VyJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICB1c2VyID0gZGF0YTtcbiAgICAgICAgfSk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHVzZXJuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJuYW1lJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlVXBkYXRlUGFzc3dvcmQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IG5ld1B3ZCA9ICQoJyNuZXdQYXNzd29yZCcpLnZhbCgpO1xuICAgIGNvbnN0IGNvbmZpcm1Qd2QgPSAkKCcjY29uZmlybVBhc3N3b3JkJykudmFsKCk7XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCduZXdQYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlybVB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChuZXdQd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1Qd2QgIT09IG5ld1B3ZCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICBzaG93TWVzc2FnZSgnQ29uZmlybSBwYXNzd29yZCBkb2VzblxcJ3QgbWF0Y2ggd2l0aCB0aGUgbmV3IHBhc3N3b3JkJywgJ2Vycm9yJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZC5sZW5ndGggIT09IDAgJiYgbmV3UHdkID09PSBjb25maXJtUHdkKSB7XG4gICAgICAkLnBvc3QoJy9mb3Jnb3RQYXNzd29yZCcsIHtcbiAgICAgICAgICBuZXdQYXNzd29yZDogbmV3UHdkLFxuICAgICAgICAgIHVzZXI6IHVzZXJcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHNob3dNZXNzYWdlKGRhdGEubXNnLCAnbXNnJyk7XG4gICAgICAgICAgJCgnLmJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgICQoJyNsb2dpbkxpbmsnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVDaGFuZ2VQYXNzd29yZChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3Qgb2xkUHdkID0gJCgnI29sZFBhc3N3b3JkJykudmFsKCk7XG4gICAgY29uc3QgbmV3UHdkID0gJCgnI25ld1Bhc3N3b3JkJykudmFsKCk7XG4gICAgY29uc3QgY29uZmlybVB3ZCA9ICQoJyNjb25maXJtUGFzc3dvcmQnKS52YWwoKTtcblxuICAgIGlmIChvbGRQd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ29sZFBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChuZXdQd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ25ld1Bhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChjb25maXJtUHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZCAhPT0gbmV3UHdkKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHNob3dNZXNzYWdlKCdDb25maXJtIHBhc3N3b3JkIGRvZXNuXFwndCBtYXRjaCB3aXRoIHRoZSBuZXcgcGFzc3dvcmQnLCAnZXJyb3InKTtcbiAgICAgIGlmIChvbGRQd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9sZFB3ZC5sZW5ndGggIT09IDAgJiYgbmV3UHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkLmxlbmd0aCAhPT0gMCAmJiBuZXdQd2QgPT09IGNvbmZpcm1Qd2QpIHtcbiAgICAgICQucG9zdCgnL3VzZXIvY2hhbmdlUGFzc3dvcmQnLCB7XG4gICAgICAgICAgb2xkUGFzc3dvcmQ6IG9sZFB3ZCxcbiAgICAgICAgICBuZXdQYXNzd29yZDogbmV3UHdkXG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBzaG93TWVzc2FnZShkYXRhLm1zZywgJ21zZycpO1xuICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cblxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlU2lnblVwKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY2xlYXJNZXNzYWdlKCk7XG5cbiAgICBjb25zdCBuYW1lID0gJChcIiN1c2VyTmFtZVwiKS52YWwoKTtcbiAgICBjb25zdCBlbWFpbCA9ICQoXCIjdXNlckVtYWlsXCIpLnZhbCgpO1xuICAgIGNvbnN0IHB3ZCA9ICQoXCIjdXNlclBhc3N3b3JkXCIpLnZhbCgpO1xuICAgIGNvbnN0IGNvbmZpcm1wd2QgPSAkKFwiI2NvbmZpcm1QYXNzd29yZFwiKS52YWwoKTtcbiAgICBjb25zdCB1c2VyTmFtZVJlZ2V4ID0gL15bYS16QS1aMC05Ll9dezEsMzB9JC87XG4gICAgY29uc3QgbmFtZVZlcmlmaWVzID0gdXNlck5hbWVSZWdleC50ZXN0KG5hbWUpO1xuXG5cbiAgICBpZiAobmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKCFuYW1lVmVyaWZpZXMgJiYgbmFtZS5sZW5ndGggIT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgIHNob3dNZXNzYWdlKCdVc2VybmFtZXMgY2FuIG9ubHkgdXNlIGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzIGFuZCBwZXJpb2RzLicsICdlcnJvcicpO1xuICAgIH1cblxuICAgIGlmIChlbWFpbC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlckVtYWlsJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChwd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJQYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlybXB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChwd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1wd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1wd2QgIT09IHB3ZCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICBzaG93TWVzc2FnZSgnQ29uZmlybSBwYXNzd29yZCBkb2VzblxcJ3QgbWF0Y2ggd2l0aCBwYXNzd29yZCcsICdlcnJvcicpO1xuICAgICAgaWYgKGVtYWlsLmxlbmd0aCA9PT0gMCB8fCBuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNvbnN0IGVycm9yID0gJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJztcbiAgICAvLyBjb25zdCBuYW1lID0gJ09MSVZFJztcbiAgICAvLyBjb25zdCBwd2QgPSAnT0xJVkUnO1xuICAgIC8vIGNvbnN0IGVtYWlsID0gJ2dlZXRhQGdtYWlsLmNvbSc7XG4gICAgaWYgKG5hbWUubGVuZ3RoICE9PSAwICYmIHB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZC5sZW5ndGggIT09IDAgJiZcbiAgICAgIGVtYWlsLmxlbmd0aCAhPT0gMCAmJiBwd2QgPT09IGNvbmZpcm1wd2QgJiYgbmFtZVZlcmlmaWVzKSB7XG4gICAgICAkLnBvc3QoJy9zaWdudXAnLCB7XG4gICAgICAgICAgdXNlcm5hbWU6IG5hbWUsXG4gICAgICAgICAgcGFzc3dvcmQ6IHB3ZCxcbiAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZVRleHQubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0WzBdLm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBzaG93TWVzc2FnZShkYXRhLm1zZywgJ21zZycpO1xuICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZGlzcGxheVNlYXJjaEJhcihlKSB7XG4gICAgaWYgKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICAkKCcjaGVhZGVyRGl2JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJyNzZWFyY2gnKS5hZGRDbGFzcygnc2hvdycpO1xuXG4gICAgLyogaGlkZSByZXN0IG9mIGRhdGEgZm9yIHNlYXJjaCB2aWV3ICovXG4gICAgJCgnLmpzLW5vblNlYXJjaFZpZXcnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJy5qcy1zZWFyY2hWaWV3JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVTZWFyY2hCYXIoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoJycpO1xuICAgICQoJyNoZWFkZXJEaXYnKS5yZW1vdmVDbGFzcygnaGlkZScpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgJCgnI3NlYXJjaCcpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG5cbiAgICAvKiBzaG93IHJlc3Qgb2YgZGF0YSBhbmQgaGlkZSBzZWFyY2ggdmlldyovXG4gICAgJCgnLmpzLW5vblNlYXJjaFZpZXcnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5qcy1zZWFyY2hWaWV3JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAvLyQoJy5qcy1zZWFyY2hWaWV3JykuZW1wdHkoKTtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoJ3VzZXInKSA9PT0gLTEpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9ICcvdXNlci9ob21lJztcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzaG93VXNlck1lbnVEKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdXNlckljb24gPSAkKCcjdXNlci1tZW51Jyk7XG4gICAgaWYgKCF1c2VySWNvbi5oYXNDbGFzcygnc2hvdycpKSB7XG4gICAgICAkKCcjdXNlci1tZW51JykuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnI3VzZXItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBzaG93VXNlck1lbnUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySWNvbiA9ICQoJyN1c2VyLW1lbnUnKTtcbiAgICAkKCcjdXNlci1tZW51JykuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICB1c2VySWNvbi5jc3MoJ3dpZHRoJywgJzI1MHB4Jyk7XG4gICAgdXNlckljb24ucHJlcGVuZCgnPGRpdiBjbGFzcz1cImNsb3NlLWljb25cIj48aSBjbGFzcz1cImZpLXhcIj48L2k+PC9kaXY+Jyk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlVXNlck1lbnUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySWNvbiA9ICQoJyN1c2VyLW1lbnUnKTtcbiAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICB1c2VySWNvbi5jc3MoJ3dpZHRoJywgJzE4MHB4Jyk7XG4gICAgJCgnLmNsb3NlLWljb24nKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoYW5nZVRyYWNrKGUpIHtcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2hpZ2hsaWdodCcpKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygxKTtcbiAgICAgICQoJy50cmFja0xpc3QnKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAgICQodGhpcykuZmluZCgnLnRyYWNrSXRlbScpLmFkZENsYXNzKCdmaS1zb3VuZCcpO1xuICAgICAgY29uc3QgdHJhY2tTcmMgPSAkKHRoaXMpLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAgICAgLy9jb25zdCBzdHIgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG4gICAgICAvL2NvbnN0IHBhdGggPSBzdHIuc3Vic3RyKDAsIHN0ci5sYXN0SW5kZXhPZihcIi9cIikgKyAxKTtcbiAgICAgIC8vY29uc3QgdHJhY2tJZCA9ICQodGhpcykuYXR0cignaWQnKTtcbiAgICAgIG1lZGlhRWxlLnNldFNyYyh0cmFja1NyYyk7XG4gICAgICBtZWRpYUVsZS5sb2FkKCk7XG4gICAgICBtZWRpYUVsZS5wbGF5KCk7XG4gICAgICAvL2hpc3RvcnkucHVzaFN0YXRlKHRyYWNrSWQsICcnLCBwYXRoICsgdHJhY2tJZCk7XG4gICAgfVxuXG4gIH1cblxuICAvKipcbiAgICogb24gcG9wc3RhdGUgaGlnaGxpZ2h0IHRoZSBwcm9wZXIgdHJhY2tcbiAgICovXG4gIC8vICQod2luZG93KS5vbigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XG4gIC8vICAgY29uc3QgdHJhY2tJZCA9IGUub3JpZ2luYWxFdmVudC5zdGF0ZTtcbiAgLy8gICBpZiAodHJhY2tJZCAhPT0gbnVsbCkge1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHt0cmFja0lkfWApLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAvLyAgICAgJCgnLnRyYWNrTGlzdCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgLy8gICAgICQoJy50cmFja0l0ZW0nKS5yZW1vdmVDbGFzcygnZmktc291bmQnKTtcbiAgLy8gICAgICQoYCMke3RyYWNrSWR9YCkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAvLyAgICAgJChgIyR7dHJhY2tJZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBjb25zdCBzdHIgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG4gIC8vICAgICBjb25zdCBpZCA9IHN0ci5zdWJzdHIoc3RyLmxhc3RJbmRleE9mKFwiL1wiKSArIDEsIHN0ci5sZW5ndGgpO1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHtpZH1gKS5kYXRhKCd0cmFjay1zcmMnKTtcbiAgLy8gICAgICQoJy50cmFja0xpc3QnKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH1cbiAgLy8gfSk7XG5cbiAgLyoqXG4gICAqIFNlYXJjaFxuICAgKi9cbiAgZnVuY3Rpb24gY2FsbFNlYXJjaChlKSB7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgIHNlYXJjaChlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZWFyY2goZSwgc3RyLCBwb3BzdGF0ZSkge1xuICAgIGlmIChlICE9PSBudWxsKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgJCgnLmpzLXNlYXJjaFZpZXcnKS5lbXB0eSgpO1xuICAgIHZhciBzZWFyY2hTdHJpbmcgPSAoc3RyICE9PSB1bmRlZmluZWQpID8gc3RyIDogJC50cmltKCQoJyNzZWFyY2gtdGV4dCcpLnZhbCgpKTsgLyogdHJpbSBiZWdpbm5pbmcgYW5kIGVuZGluZyBzcGFjZXMgKi9cbiAgICBzZWFyY2hTdHJpbmcgPSBzZWFyY2hTdHJpbmcucmVwbGFjZSgvXFxzKy9nLCAnICcpO1xuICAgIGlmIChzZWFyY2hTdHJpbmcubGVuZ3RoID4gMCAmJiBzZWFyY2hTdHJpbmcgIT09ICcgJykge1xuICAgICAgJC5wb3N0KGAvc2VhcmNoLyR7c2VhcmNoU3RyaW5nfWApXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAkKCcjc2VhcmNoQ29udCcpLmh0bWwoZGF0YSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAkKCcjc2VhcmNoQ29udCcpLmh0bWwoZGF0YSk7XG4gICAgICAgICAgJCgnI2pzLXNlYXJjaFJlc3VsdHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgIGlmIChwb3BzdGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBzdHIgPSBgL3NlYXJjaC8ke3NlYXJjaFN0cmluZ31gO1xuICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoe1xuICAgICAgICAgICAgICBzZWFyY2g6IHNlYXJjaFN0cmluZ1xuICAgICAgICAgICAgfSwgJycsIHN0cik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb25zb2xlLmxvZyh3aW5kb3cuaGlzdG9yeS5zdGF0ZSk7XG4gIGNvbnNvbGUubG9nKHdpbmRvdy5oaXN0b3J5KTtcblxuICBpZiAod2luZG93Lmhpc3Rvcnkuc3RhdGUgIT09IG51bGwpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnN0YXRlO1xuICAgIGlmIChzdGF0ZS5zZWFyY2ggIT09IHVuZGVmaW5lZCAmJiBzdGF0ZS5jYXRlZ29yeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBkaXNwbGF5U2VhcmNoQmFyKCk7XG4gICAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoc3RhdGUuc2VhcmNoKTtcbiAgICAgIHNlYXJjaChudWxsLCBzdGF0ZS5zZWFyY2gsICdub1BvcHN0YXRlJyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZS5zZWFyY2ggIT09IHVuZGVmaW5lZCAmJiBzdGF0ZS5jYXRlZ29yeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBkaXNwbGF5U2VhcmNoQmFyKCk7XG4gICAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoc3RhdGUuc2VhcmNoKTtcbiAgICAgIHNlZUFsbFJlc3VsdHMobnVsbCwgc3RhdGUuc2VhcmNoLCBzdGF0ZS5jYXRlZ29yeSwgJ25vUG9wc3RhdGUnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogb24gcG9wc3RhdGUgaGlnaGxpZ2h0IGdldCB0aGUgcHJvcGVyIHZpZXdcbiAgICovXG5cbiAgJCh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsIGZ1bmN0aW9uKGUpIHtcbiAgICBjb25zdCBzdGF0ZSA9IGUub3JpZ2luYWxFdmVudC5zdGF0ZTtcblxuICAgIGlmIChzdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgY29uc3QgcGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBwYXRoO1xuICAgIH0gZWxzZSBpZiAoc3RhdGUuc2VhcmNoICE9PSB1bmRlZmluZWQgJiYgc3RhdGUuY2F0ZWdvcnkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZGlzcGxheVNlYXJjaEJhcihlKTtcbiAgICAgICQoJyNzZWFyY2gtdGV4dCcpLnZhbChzdGF0ZS5zZWFyY2gpO1xuICAgICAgc2VhcmNoKGUsIHN0YXRlLnNlYXJjaCwgJ25vUG9wc3RhdGUnKTtcbiAgICB9IGVsc2UgaWYgKHN0YXRlLnNlYXJjaCAhPT0gdW5kZWZpbmVkICYmIHN0YXRlLmNhdGVnb3J5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGRpc3BsYXlTZWFyY2hCYXIoZSk7XG4gICAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoc3RhdGUuc2VhcmNoKTtcbiAgICAgIHNlZUFsbFJlc3VsdHMoZSwgc3RhdGUuc2VhcmNoLCBzdGF0ZS5jYXRlZ29yeSwgJ25vUG9wc3RhdGUnKTtcbiAgICB9XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHNlZUFsbFJlc3VsdHMoZSwgc3JjaFN0ciwgY2F0ZWdyeSwgcG9wc3RhdGUpIHtcbiAgICBpZiAoZSAhPT0gbnVsbCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblxuICAgIGNvbnN0IHNlYXJjaFN0ciA9IChzcmNoU3RyICE9PSB1bmRlZmluZWQpID8gc3JjaFN0ciA6ICQoJy5zZWFyY2hTdHInKS5odG1sKCk7XG4gICAgY29uc3QgY2F0ZWdvcnkgPSAoY2F0ZWdyeSAhPT0gdW5kZWZpbmVkKSA/IGNhdGVncnkgOiAkKHRoaXMpLmRhdGEoJ2NhdGVnb3J5Jyk7XG5cbiAgICAkLnBvc3QoYC9zZWFyY2gvJHtjYXRlZ29yeX0vJHtzZWFyY2hTdHJ9YClcbiAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgJCgnI3NlYXJjaENvbnQnKS5odG1sKGRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgJCgnI3NlYXJjaENvbnQnKS5odG1sKGRhdGEpO1xuICAgICAgICAkKCcjanMtc2VhcmNoUmVzdWx0cycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIGlmIChwb3BzdGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY29uc3Qgc3RyID0gYC9zZWFyY2gvJHtjYXRlZ29yeX0vJHtzZWFyY2hTdHJ9YDtcbiAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZSh7XG4gICAgICAgICAgICBzZWFyY2g6IHNlYXJjaFN0cixcbiAgICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeVxuICAgICAgICAgIH0sICcnLCBzdHIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxpbmtBY3RpdmUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVBsYXlsaXN0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIH1cblxuICAvKipcbiAgICogVXRpbGl0eSBmdW5jdGlvbnNcbiAgICovXG5cbiAgZnVuY3Rpb24gY2xlYXJNZXNzYWdlKCkge1xuICAgICQoJyNlcnJvcicpLmVtcHR5KCk7XG4gICAgJCgnI21zZycpLmVtcHR5KCk7XG4gICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuaWNvbi1lcnJvcicpLnJlbW92ZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd01lc3NhZ2UobXNnVHh0LCBtc2dEaXYpIHtcbiAgICB2YXIgdWxFbGUgPSAkKCcjbXNnY29udCcpO1xuICAgIGlmICh1bEVsZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHVsRWxlID0gJCgnPHVsIGlkPVxcJ21zZ2NvbnRcXCc+PC91bD4nKTtcbiAgICB9XG4gICAgdWxFbGUuYXBwZW5kKCc8bGk+JyArIG1zZ1R4dCArICc8L2xpPicpO1xuICAgICQoJyMnICsgbXNnRGl2KS5odG1sKHVsRWxlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dFcnJvckNpcmNsZShjaXJjbGVJbnApIHtcbiAgICBjb25zdCBpbnBFbGUgPSAkKCcjJyArIGNpcmNsZUlucCk7XG4gICAgY29uc3Qgc3BhbkVsZSA9ICQoJzxzcGFuIGNsYXNzPVxcJ2ljb24tZXJyb3JcXCc+PGkgY2xhc3M9XFwnZmkteC1jaXJjbGVcXCc+PC9pPjwvc3Bhbj4nKTtcbiAgICBpbnBFbGUuYWZ0ZXIoc3BhbkVsZSk7XG4gIH1cblxuXG5cblxufSgpKTtcbiJdfQ==
