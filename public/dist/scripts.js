"use strict";$(function(){var e=null;$(document).foundation(),$(".screenText").slick({dots:!0,infinite:!0,speed:500,fade:!0,cssEase:"linear"}),window.location.pathname.indexOf("play")&&$("#audioPlayer").mediaelementplayer({stretching:"responsive",pluginPath:"../js/lib/build/",success:function(s,r,n){console.log(s),e=s,$(s).on("ended",function(){var s=$("li.trackList.highlight").next();0===s.length?function(s){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),s.addClass("highlight"),s.find(".trackItem").addClass("fi-sound");var r=s.data("track-src");e.setSrc(r),e.load()}($("li.trackList").first()):s.click()})},error:function(e,s){alert("There is some error at the server playing the track!")}}),$(window).on("load resize",function(){$("#footer");$(".title-bar").is(":visible")?$("#index-menu").removeClass("addFloat"):$("#index-menu").addClass("addFloat");$(window).width()<400?($(".menuDiv").addClass("menuMode"),$("#user-menu").removeClass("show")):($("#user-menu").removeClass("show"),$("#user-menu").css("width","180px"),$(".close-icon").remove(),$(".menuDiv").removeClass("menuMode"))}),$("#login").on("submit",function(e){e.preventDefault(),n();var s=$("#userName").val(),r=$("#userPassword").val();if(0!==s.length&&0!==r.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(s);t?$.post("/login",{username:s,password:r}).fail(function(e){var s=e.responseJSON;400===e.status&&a(s[0].msg,"error"),401===e.status&&a(s.msg,"error")}).done(function(e){window.location.href="/user/home"}):(o("userName"),a("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(o("userName"),$("#emptyFields").removeClass("hide")),0==r.length&&(o("userPassword"),$("#emptyFields").removeClass("hide"))}),$("#editProfile").on("submit",function(e){e.preventDefault(),n();var s=$("#userName").val(),r=$("#email").val();if(0!==s.length&&0!==r.length){var t=/^[a-zA-Z0-9._]{1,30}$/.test(s);t?$.post("/user/editProfile",{username:s,email:r}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?a(s[0].msg,"error"):a(s.msg,"error")}}).done(function(e){a(e.msg,"msg"),$("#loginLink").removeClass("hide"),$(".btns").addClass("hide")}):(o("userName"),a("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(o("userName"),$("#emptyFields").removeClass("hide")),0==r.length&&(o("email"),$("#emptyFields").removeClass("hide"))}),$("#confirmUser").on("submit",function(e){e.preventDefault(),n();var r=$("#username").val();0!==r.length?$.post("/verifyUser",{username:r}).fail(function(e){if(401===e.status){var s=e.responseJSON;a(s.msg,"error")}}).done(function(e){$("#username").val(""),$("#forgotPassword").removeClass("hide"),$("#confirmUser").addClass("hide"),s=e}):0===r.length&&(o("username"),$("#emptyFields").removeClass("hide"))}),$("#forgotPassword").on("submit",function(e){e.preventDefault(),n();var r=$("#newPassword").val(),t=$("#confirmPassword").val();0===r.length&&(o("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(o("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==r.length&&t!==r&&(o("confirmPassword"),$("#emptyFields").addClass("hide"),a("Confirm password doesn't match with the new password","error"));0!==r.length&&0!==t.length&&r===t&&$.post("/forgotPassword",{newPassword:r,user:s}).fail(function(e){if(400===e.status){var s=e.responseJSON;a(s.msg,"error")}}).done(function(e){a(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#signup").on("submit",function(e){e.preventDefault(),n();var s=$("#userName").val(),r=$("#userEmail").val(),t=$("#userPassword").val(),i=$("#confirmPassword").val(),l=/^[a-zA-Z0-9._]{1,30}$/.test(s);0===s.length&&(o("userName"),$("#emptyFields").removeClass("hide"));l||0===s.length||(o("userName"),a("Usernames can only use letters, numbers, underscores and periods.","error"));0===r.length&&(o("userEmail"),$("#emptyFields").removeClass("hide"));0===t.length&&(o("userPassword"),$("#emptyFields").removeClass("hide"));0===i.length&&(o("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==t.length&&0!==i.length&&i!==t&&(o("confirmPassword"),$("#emptyFields").addClass("hide"),a("Confirm password doesn't match with password","error"),0!==r.length&&0!==s.length||$("#emptyFields").removeClass("hide"));0!==s.length&&0!==t.length&&0!==i.length&&0!==r.length&&t===i&&l&&$.post("/signup",{username:s,password:t,email:r}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?a(s[0].msg,"error"):a(s.msg,"error")}}).done(function(e){a(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#reset").on("click",n),$("#changePassword").on("submit",function(e){e.preventDefault(),n();var s=$("#oldPassword").val(),r=$("#newPassword").val(),t=$("#confirmPassword").val();0===s.length&&(o("oldPassword"),$("#emptyFields").removeClass("hide"));0===r.length&&(o("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(o("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==r.length&&0!==t.length&&t!==r&&(o("confirmPassword"),$("#emptyFields").addClass("hide"),a("Confirm password doesn't match with the new password","error"),0===s.length&&$("#emptyFields").removeClass("hide"));0!==s.length&&0!==r.length&&0!==t.length&&r===t&&$.post("/user/changePassword",{oldPassword:s,newPassword:r}).fail(function(e){if(400===e.status){var s=e.responseJSON;a(s.msg,"error")}}).done(function(e){a(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#searchIcon").on("click",function(e){e.preventDefault(),$("#headerDiv").removeClass("show").addClass("hide"),$("#search").addClass("show"),$(".js-nonSearchView").addClass("hide"),$(".js-searchView").removeClass("hide")}),$(".js-search-close").on("click",function(e){e.preventDefault(),$("#search-text").val(""),$("#headerDiv").removeClass("hide").addClass("show"),$("#search").removeClass("show"),$(".js-nonSearchView").removeClass("hide"),$(".js-searchView").addClass("hide"),$(".js-searchView").empty()}),$(".menuDiv").on("click",function(e){e.preventDefault(),$("#user-menu").hasClass("show")?$("#user-menu").removeClass("show"):$("#user-menu").addClass("show")}),$(".trackList").on("click",function(s){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),$(this).addClass("highlight"),$(this).find(".trackItem").addClass("fi-sound");var r=$(this).data("track-src");e.setSrc(r),e.load(),e.play()}),$("#search-text").on("keyup",function(e){13===e.keyCode&&r(e)}),$(".js-search-icon").on("click",r),$(document).on("click",".menuMode",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").addClass("show"),s.css("width","250px"),s.prepend('<div class="close-icon"><i class="fi-x"></i></div>')}),$(document).on("click",".close-icon",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").removeClass("show"),s.css("width","180px"),$(".close-icon").remove()});var s=null;function r(e){e.preventDefault(),$(".js-searchView").empty();var s=$.trim($("#search-text").val());(s=s.replace(/\s+/g," ")).length>0&&" "!==s&&(console.log("here"+s),$.post("/search/"+s).fail(function(e){console.log(e)}).done(function(e){console.log(e),$("#searchCont").html(e),$("#js-searchResults").removeClass("hide")}))}function n(){$("#error").empty(),$("#msg").empty(),$("#emptyFields").addClass("hide"),$(".icon-error").remove()}function a(e,s){var r=$("#msgcont");0===r.length&&(r=$("<ul id='msgcont'></ul>")),r.append("<li>"+e+"</li>"),$("#"+s).html(r)}function o(e){var s=$("#"+e),r=$("<span class='icon-error'><i class='fi-x-circle'></i></span>");s.after(r)}}());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsIm1lZGlhRWxlIiwiZG9jdW1lbnQiLCJmb3VuZGF0aW9uIiwic2xpY2siLCJkb3RzIiwiaW5maW5pdGUiLCJzcGVlZCIsIndpbmRvdyIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJpbmRleE9mIiwibWVkaWFlbGVtZW50cGxheWVyIiwicGx1Z2luUGF0aCIsInN1Y2Nlc3MiLCJtZWRpYUVsZW1lbnQiLCJvcmlnaW5hbE5vZGUiLCJpbnN0YW5jZSIsImNvbnNvbGUiLCJsb2ciLCJsaUVsZSIsIm5leHQiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiZmluZCIsImRhdGEiLCJzZXRTcmMiLCJ0cmFja1NyYyIsImxvYWQiLCJjYWxsRm9jdXMiLCJmaXJzdCIsImVycm9yIiwiYWxlcnQiLCJvbiIsImlzIiwid2lkdGgiLCJjc3MiLCJyZW1vdmUiLCJlIiwicHJldmVudERlZmF1bHQiLCJjbGVhck1lc3NhZ2UiLCJuYW1lIiwidmFsIiwicHdkIiwibGVuZ3RoIiwibmFtZVZlcmlmaWVzIiwidGVzdCIsInBvc3QiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZmFpbCIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlSlNPTiIsInNob3dNZXNzYWdlIiwibXNnIiwiZG9uZSIsImhyZWYiLCJzaG93RXJyb3JDaXJjbGUiLCJlbWFpbCIsInBhdHRlcm4iLCJzdGF0dXMiLCJoYW5kbGVWZXJpZnlVc2VyIiwidXNlciIsIm5ld1B3ZCIsImNvbmZpcm1Qd2QiLCJuZXdQYXNzd29yZCIsImhhbmRsZUNoYW5nZVBhc3N3b3JkIiwib2xkUHdkIiwiY29uZmlybXB3ZCIsImRpc3BsYXlTZWFyY2hCYXIiLCJvbGRQYXNzd29yZCIsImhhbmRsZVNpZ25VcCIsInVzZXJOYW1lUmVnZXgiLCJlbXB0eSIsInNob3dVc2VyTWVudUQiLCJzaG93VXNlck1lbnUiLCJ1c2VySWNvbiIsImhhc0NsYXNzIiwidGhpcyIsInBsYXkiLCJrZXlDb2RlIiwic2VhcmNoIiwiY2hhbmdlVHJhY2siLCJzZWFyY2hTdHJpbmciLCJyZXBsYWNlIiwibXNnVHh0IiwidWxFbGUiLCJhcHBlbmQiLCJtc2dEaXYiLCJodG1sIiwiY2lyY2xlSW5wIiwiaW5wRWxlIiwic3BhbkVsZSIsImFmdGVyIl0sIm1hcHBpbmdzIjoiYUFBQUEsRUFBRSxXQUFBLElBQUFDLEVBQVcsS0FPWEQsRUFBRUUsVUFBVUMsYUFLWkgsRUFBRSxlQUFlSSxPQUNmQyxNQUFNLEVBRE5DLFVBQUEsRUFDQUQsTUFBTSxJQUNOQyxNQUFBQSxFQUNBQyxRQUFPLFdBUUxDLE9BQU9DLFNBQVNDLFNBQVNDLFFBQVEsU0FDbkNYLEVBQUUsZ0JBQWdCWSxvQkFEaEJKLFdBQU9DLGFBQ1BJLFdBQUEsbUJBR0FDLFFBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQUMsUUFBQUMsSUFBQUosR0FDQUQsRUFBU0MsRUFFUGQsRUFBQUEsR0FBV2MsR0FBQUEsUUFBWCxXQUNBLElBQUFLLEVBQUFwQixFQUFBLDBCQUFBcUIsT0FDbUIsSUFBakJOLEVBQUFBLE9BYVAsU0FBQUssR0FHQ3BCLEVBQUUsY0FBY3NCLFlBQVksYUFEOUJ0QixFQUFBLGNBQUFzQixZQUEwQixZQUN4QnRCLEVBQUV1QixTQUFGLGFBQ0F2QixFQUFFd0IsS0FBQSxjQUFjRixTQUFZLFlBQzVCRixJQUFNRyxFQUFTSCxFQUFBSyxLQUFmLGFBSUF4QixFQUFBeUIsT0FBQUMsR0FDQTFCLEVBQUEyQixPQXRCTUMsQ0FBWTdCLEVBQUUsZ0JBQUE4QixTQUVaRCxFQUFBQSxXQUlIRSxNQVBELFNBQUFoQixFQUFBQyxHQVRpQ2dCLE1BQUEsMkRBeUN2Q2hDLEVBQUVRLFFBQVF5QixHQUFHLGNBc0JiLFdBQ21CakMsRUFBQSxXQUNiQSxFQUFFLGNBQWNrQyxHQUFHLFlBQ3JCbEMsRUFBRSxlQUFlc0IsWUFBWSxZQUU3QnRCLEVBQUUsZUFBZXVCLFNBQVMsWUFFaEJ2QixFQUFFUSxRQUFRMkIsUUFDVixLQUNWbkMsRUFBRSxZQUFZdUIsU0FBUyxZQUN2QnZCLEVB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UyxTQXNCeEJwQyxFQUFBLGVBQUFxQyxXQXJZQSxJQUFJeUIsRUFBTyxLQW1jWCxTQUFTdEIsRUFBQUEsR0FDUHhDLEVBQUV1QyxpQkFDRnZDLEVBQUUsa0JBQUZ5RSxRQUNBekUsSUFBRW1GLEVBQWdCNUQsRUFBQUEsS0FBbEJ2QixFQUEyQixnQkFBM0IwQyxRQUNBMUMsRUFBQW1GLEVBQUFDLFFBQUEsT0FBQSxNQUNEeEMsT0FBQSxHQUFBLE1BQUF1QyxJQXpCR2pFLFFBQVFDLElBQUksT0FBT2dFLEdBMkJ2Qm5GLEVBQUErQyxLQUFBLFdBQXFCc0MsR0FDZkMsS0FBQUEsU0FBVTdELEdBQ1Y2RCxRQUFNMUMsSUFBTm5CLEtBRUg4QixLQUFBLFNBQUE5QixHQUNLOEQsUUFBT3BFLElBQUFNLEdBQ1h6QixFQUFNd0YsZUFBYUYsS0FBckI3RCxHQUNEekIsRUFBQSxxQkFBQXNCLFlBQUEsV0FkRCxTQUFTa0IsSUFDUHhDLEVBQUUsVUFBVXlFLFFBQ1p6RSxFQUFFLFFBQVF5RSxRQUNWekUsRUFBRSxnQkFBZ0J1QixTQUFTLFFBQzNCdkIsRUFBRSxlQUFlcUMsU0FHbkIsU0FBU2dCLEVBQVlnQyxFQUFRRyxHQUMzQixJQUFJRixFQUFRdEYsRUFBRSxZQUNPLElBQWpCc0YsRUFBTTFDLFNBQ1IwQyxFQUFRdEYsRUFBRSwyQkFFWnNGLEVBQU1DLE9BQU8sT0FBU0YsRUFBUyxTQUMvQnJGLEVBQUUsSUFBTXdGLEdBQVFDLEtBQUtILEdBR3ZCLFNBQVM3QixFQUFnQmlDLEdBQ3ZCLElBQU1DLEVBQVMzRixFQUFFLElBQU0wRixHQUNqQkUsRUFBVTVGLEVBQUUsK0RBQ2xCMkYsRUFBT0UsTUFBTUQsSUF6aUJmIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uKCkge1xuXG4gIHZhciBtZWRpYUVsZSA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgZm91bmRhdGlvblxuICAgKi9cbiAgJChkb2N1bWVudCkuZm91bmRhdGlvbigpO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHNsaWRlclxuICAgKi9cbiAgJCgnLnNjcmVlblRleHQnKS5zbGljayh7XG4gICAgZG90czogdHJ1ZSxcbiAgICBpbmZpbml0ZTogdHJ1ZSxcbiAgICBzcGVlZDogNTAwLFxuICAgIGZhZGU6IHRydWUsXG4gICAgY3NzRWFzZTogJ2xpbmVhcidcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYXVkaW8gcGxheWVyXG4gICAqL1xuICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoJ3BsYXknKSkge1xuICAgICQoJyNhdWRpb1BsYXllcicpLm1lZGlhZWxlbWVudHBsYXllcih7XG4gICAgICBzdHJldGNoaW5nOiAncmVzcG9uc2l2ZScsXG4gICAgICBwbHVnaW5QYXRoOiAnLi4vanMvbGliL2J1aWxkLycsXG4gICAgICAvLyBXaGVuIHVzaW5nIGpRdWVyeSdzIGBtZWRpYWVsZW1lbnRwbGF5ZXJgLCBhbiBgaW5zdGFuY2VgIGFyZ3VtZW50XG4gICAgICAvLyBpcyBhdmFpbGFibGUgaW4gdGhlIGBzdWNjZXNzYCBjYWxsYmFja1xuICAgICAgc3VjY2VzczogZnVuY3Rpb24obWVkaWFFbGVtZW50LCBvcmlnaW5hbE5vZGUsIGluc3RhbmNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKG1lZGlhRWxlbWVudClcbiAgICAgICAgbWVkaWFFbGUgPSBtZWRpYUVsZW1lbnQ7XG4gICAgICAgIC8vbWVkaWFFbGUucGxheSgpO1xuICAgICAgICAkKG1lZGlhRWxlbWVudCkub24oJ2VuZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGxpRWxlID0gJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLm5leHQoKTtcbiAgICAgICAgICBpZiAobGlFbGUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjYWxsRm9jdXMoJCgnbGkudHJhY2tMaXN0JykuZmlyc3QoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpRWxlLmNsaWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihtZWRpYUVsZW1lbnQsIG9yaWdpbmFsTm9kZSkge1xuICAgICAgICBhbGVydCgnVGhlcmUgaXMgc29tZSBlcnJvciBhdCB0aGUgc2VydmVyIHBsYXlpbmcgdGhlIHRyYWNrIScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY2FsbEZvY3VzKGxpRWxlKSB7XG4gICAgJCgnLnRyYWNrTGlzdCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gICAgbGlFbGUuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgIGxpRWxlLmZpbmQoJy50cmFja0l0ZW0nKS5hZGRDbGFzcygnZmktc291bmQnKTtcbiAgICBjb25zdCB0cmFja1NyYyA9IGxpRWxlLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAgIC8vIGNvbnN0IHN0ciA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcbiAgICAvLyBjb25zdCBwYXRoID0gc3RyLnN1YnN0cigwLCBzdHIubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgLy8gY29uc3QgdHJhY2tJZCA9IGxpRWxlLmF0dHIoJ2lkJyk7XG4gICAgbWVkaWFFbGUuc2V0U3JjKHRyYWNrU3JjKTtcbiAgICBtZWRpYUVsZS5sb2FkKCk7XG4gICAgLy9oaXN0b3J5LnB1c2hTdGF0ZSh0cmFja0lkLCAnJywgcGF0aCArIHRyYWNrSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGZ1bmN0aW9uc1xuICAgKi9cbiAgJCh3aW5kb3cpLm9uKCdsb2FkIHJlc2l6ZScsIGhhbmRsZUxvYWQpO1xuICAkKCcjbG9naW4nKS5vbignc3VibWl0JywgaGFuZGxlTG9naW4pOyAvKiBvbiBsb2dpbiAqL1xuICAkKCcjZWRpdFByb2ZpbGUnKS5vbignc3VibWl0JywgaGFuZGxlVXBkYXRlUHJvZmlsZSk7IC8qIHVwZGF0ZSBwcm9maWxlICovXG4gICQoJyNjb25maXJtVXNlcicpLm9uKCdzdWJtaXQnLCBoYW5kbGVWZXJpZnlVc2VyKTsgLyogdmVyaWZ5IHVzZXIgKi9cbiAgJCgnI2ZvcmdvdFBhc3N3b3JkJykub24oJ3N1Ym1pdCcsIGhhbmRsZVVwZGF0ZVBhc3N3b3JkKTsgLyogcG9zdCB1cGRhdGUgcGFzc3dvcmQgKi9cbiAgJCgnI3NpZ251cCcpLm9uKCdzdWJtaXQnLCBoYW5kbGVTaWduVXApOyAvKiBTaWduIHVwICovXG4gICQoJyNyZXNldCcpLm9uKCdjbGljaycsIGNsZWFyTWVzc2FnZSk7IC8qIENsZWFyIG1lc3NhZ2VzIG9uIGNsaWNrIG9mIHJlc2V0ICovXG4gICQoJyNjaGFuZ2VQYXNzd29yZCcpLm9uKCdzdWJtaXQnLCBoYW5kbGVDaGFuZ2VQYXNzd29yZCk7IC8qIHBvc3QgY2hhbmdlIHBhc3N3b3JkICovXG4gICQoJyNzZWFyY2hJY29uJykub24oJ2NsaWNrJywgZGlzcGxheVNlYXJjaEJhcik7XG4gICQoJy5qcy1zZWFyY2gtY2xvc2UnKS5vbignY2xpY2snLCBoaWRlU2VhcmNoQmFyKTtcbiAgJCgnLm1lbnVEaXYnKS5vbignY2xpY2snLCBzaG93VXNlck1lbnVEKTtcbiAgJCgnLnRyYWNrTGlzdCcpLm9uKCdjbGljaycsIGNoYW5nZVRyYWNrKTsgLyogY2hhbmdlIHRyYWNrIG9uIGNsaWNrICovXG4gICQoJyNzZWFyY2gtdGV4dCcpLm9uKCdrZXl1cCcsIGNhbGxTZWFyY2gpOyAvKiBzZWFyY2ggZnVuY3Rpb25hbGl0eSAqL1xuICAkKCcuanMtc2VhcmNoLWljb24nKS5vbignY2xpY2snLCBzZWFyY2gpOyAvKiBzZWFyY2ggZnVuY3Rpb25hbGl0eSAqL1xuICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLm1lbnVNb2RlJywgc2hvd1VzZXJNZW51KTtcbiAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jbG9zZS1pY29uJywgaGlkZVVzZXJNZW51KTtcblxuXG4gIHZhciB1c2VyID0gbnVsbDtcblxuXG4gIC8qIGZ1bmN0aW9ucyAqL1xuICBmdW5jdGlvbiBoYW5kbGVMb2FkKCkge1xuICAgIGNvbnN0IGZvb3RlciA9ICQoJyNmb290ZXInKTtcbiAgICBpZiAoJCgnLnRpdGxlLWJhcicpLmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAkKCcjaW5kZXgtbWVudScpLnJlbW92ZUNsYXNzKCdhZGRGbG9hdCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjaW5kZXgtbWVudScpLmFkZENsYXNzKCdhZGRGbG9hdCcpO1xuICAgIH1cbiAgICB2YXIgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcbiAgICBpZiAod2lkdGggPCA0MDApIHtcbiAgICAgICQoJy5tZW51RGl2JykuYWRkQ2xhc3MoJ21lbnVNb2RlJyk7XG4gICAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnI3VzZXItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAkKCcjdXNlci1tZW51JykuY3NzKCd3aWR0aCcsICcxODBweCcpO1xuICAgICAgJCgnLmNsb3NlLWljb24nKS5yZW1vdmUoKTtcbiAgICAgICQoJy5tZW51RGl2JykucmVtb3ZlQ2xhc3MoJ21lbnVNb2RlJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlTG9naW4oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjbGVhck1lc3NhZ2UoKTtcbiAgICBjb25zdCBuYW1lID0gJCgnI3VzZXJOYW1lJykudmFsKCk7XG4gICAgY29uc3QgcHdkID0gJCgnI3VzZXJQYXNzd29yZCcpLnZhbCgpO1xuXG4gICAgaWYgKG5hbWUubGVuZ3RoICE9PSAwICYmIHB3ZC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnN0IHVzZXJOYW1lUmVnZXggPSAvXlthLXpBLVowLTkuX117MSwzMH0kLztcbiAgICAgIGNvbnN0IG5hbWVWZXJpZmllcyA9IHVzZXJOYW1lUmVnZXgudGVzdChuYW1lKTtcblxuICAgICAgaWYgKG5hbWVWZXJpZmllcykge1xuICAgICAgICAkLnBvc3QoJy9sb2dpbicsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBuYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHB3ZFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHRbMF0ubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3VzZXIvaG9tZSc7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAgIHNob3dNZXNzYWdlKCdVc2VybmFtZXMgY2FuIG9ubHkgdXNlIGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzIGFuZCBwZXJpb2RzLicsICdlcnJvcicpO1xuXG4gICAgICB9XG4gICAgfSBlbHNlIHtcblxuICAgICAgaWYgKG5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgIGlmIChwd2QubGVuZ3RoID09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyUGFzc3dvcmQnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVVcGRhdGVQcm9maWxlKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IHVzZXJuYW1lID0gJCgnI3VzZXJOYW1lJykudmFsKCk7XG4gICAgY29uc3QgZW1haWwgPSAkKCcjZW1haWwnKS52YWwoKTtcblxuICAgIGlmICh1c2VybmFtZS5sZW5ndGggIT09IDAgJiYgZW1haWwubGVuZ3RoICE9PSAwKSB7XG5cbiAgICAgIGNvbnN0IHBhdHRlcm4gPSAvXlthLXpBLVowLTkuX117MSwzMH0kLztcbiAgICAgIGNvbnN0IG5hbWVWZXJpZmllcyA9IHBhdHRlcm4udGVzdCh1c2VybmFtZSk7XG4gICAgICBpZiAobmFtZVZlcmlmaWVzKSB7XG4gICAgICAgICQucG9zdCgnL3VzZXIvZWRpdFByb2ZpbGUnLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgICBpZiAocmVzcG9uc2VUZXh0Lmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0WzBdLm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKGRhdGEubXNnLCAnbXNnJyk7XG4gICAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgc2hvd01lc3NhZ2UoJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJywgJ2Vycm9yJyk7XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHVzZXJuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgICBpZiAoZW1haWwubGVuZ3RoID09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdlbWFpbCcpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVZlcmlmeVVzZXIoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgdXNlcm5hbWUgPSAkKCcjdXNlcm5hbWUnKS52YWwoKTtcblxuICAgIGlmICh1c2VybmFtZS5sZW5ndGggIT09IDApIHtcblxuICAgICAgJC5wb3N0KCcvdmVyaWZ5VXNlcicsIHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICQoJyN1c2VybmFtZScpLnZhbCgnJyk7XG4gICAgICAgICAgJCgnI2ZvcmdvdFBhc3N3b3JkJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjY29uZmlybVVzZXInKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgIHVzZXIgPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodXNlcm5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlcm5hbWUnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVVcGRhdGVQYXNzd29yZChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgbmV3UHdkID0gJCgnI25ld1Bhc3N3b3JkJykudmFsKCk7XG4gICAgY29uc3QgY29uZmlybVB3ZCA9ICQoJyNjb25maXJtUGFzc3dvcmQnKS52YWwoKTtcblxuICAgIGlmIChuZXdQd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ25ld1Bhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChjb25maXJtUHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZCAhPT0gbmV3UHdkKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHNob3dNZXNzYWdlKCdDb25maXJtIHBhc3N3b3JkIGRvZXNuXFwndCBtYXRjaCB3aXRoIHRoZSBuZXcgcGFzc3dvcmQnLCAnZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkLmxlbmd0aCAhPT0gMCAmJiBuZXdQd2QgPT09IGNvbmZpcm1Qd2QpIHtcbiAgICAgICQucG9zdCgnL2ZvcmdvdFBhc3N3b3JkJywge1xuICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdQd2QsXG4gICAgICAgICAgdXNlcjogdXNlclxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YS5tc2csICdtc2cnKTtcbiAgICAgICAgICAkKCcuYnRucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgJCgnI2xvZ2luTGluaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUNoYW5nZVBhc3N3b3JkKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY2xlYXJNZXNzYWdlKCk7XG5cbiAgICBjb25zdCBvbGRQd2QgPSAkKCcjb2xkUGFzc3dvcmQnKS52YWwoKTtcbiAgICBjb25zdCBuZXdQd2QgPSAkKCcjbmV3UGFzc3dvcmQnKS52YWwoKTtcbiAgICBjb25zdCBjb25maXJtUHdkID0gJCgnI2NvbmZpcm1QYXNzd29yZCcpLnZhbCgpO1xuXG4gICAgaWYgKG9sZFB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnb2xkUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnbmV3UGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpcm1Qd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkICE9PSBuZXdQd2QpIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgc2hvd01lc3NhZ2UoJ0NvbmZpcm0gcGFzc3dvcmQgZG9lc25cXCd0IG1hdGNoIHdpdGggdGhlIG5ldyBwYXNzd29yZCcsICdlcnJvcicpO1xuICAgICAgaWYgKG9sZFB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2xkUHdkLmxlbmd0aCAhPT0gMCAmJiBuZXdQd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1Qd2QubGVuZ3RoICE9PSAwICYmIG5ld1B3ZCA9PT0gY29uZmlybVB3ZCkge1xuICAgICAgJC5wb3N0KCcvdXNlci9jaGFuZ2VQYXNzd29yZCcsIHtcbiAgICAgICAgICBvbGRQYXNzd29yZDogb2xkUHdkLFxuICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdQd2RcbiAgICAgICAgfSlcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHNob3dNZXNzYWdlKGRhdGEubXNnLCAnbXNnJyk7XG4gICAgICAgICAgJCgnLmJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgICQoJyNsb2dpbkxpbmsnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuXG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVTaWduVXAoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IG5hbWUgPSAkKFwiI3VzZXJOYW1lXCIpLnZhbCgpO1xuICAgIGNvbnN0IGVtYWlsID0gJChcIiN1c2VyRW1haWxcIikudmFsKCk7XG4gICAgY29uc3QgcHdkID0gJChcIiN1c2VyUGFzc3dvcmRcIikudmFsKCk7XG4gICAgY29uc3QgY29uZmlybXB3ZCA9ICQoXCIjY29uZmlybVBhc3N3b3JkXCIpLnZhbCgpO1xuICAgIGNvbnN0IHVzZXJOYW1lUmVnZXggPSAvXlthLXpBLVowLTkuX117MSwzMH0kLztcbiAgICBjb25zdCBuYW1lVmVyaWZpZXMgPSB1c2VyTmFtZVJlZ2V4LnRlc3QobmFtZSk7XG5cblxuICAgIGlmIChuYW1lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIW5hbWVWZXJpZmllcyAmJiBuYW1lLmxlbmd0aCAhPT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgc2hvd01lc3NhZ2UoJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJywgJ2Vycm9yJyk7XG4gICAgfVxuXG4gICAgaWYgKGVtYWlsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyRW1haWwnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKHB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlclBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChjb25maXJtcHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKHB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybXB3ZCAhPT0gcHdkKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHNob3dNZXNzYWdlKCdDb25maXJtIHBhc3N3b3JkIGRvZXNuXFwndCBtYXRjaCB3aXRoIHBhc3N3b3JkJywgJ2Vycm9yJyk7XG4gICAgICBpZiAoZW1haWwubGVuZ3RoID09PSAwIHx8IG5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gY29uc3QgZXJyb3IgPSAnVXNlcm5hbWVzIGNhbiBvbmx5IHVzZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyBhbmQgcGVyaW9kcy4nO1xuICAgIC8vIGNvbnN0IG5hbWUgPSAnT0xJVkUnO1xuICAgIC8vIGNvbnN0IHB3ZCA9ICdPTElWRSc7XG4gICAgLy8gY29uc3QgZW1haWwgPSAnZ2VldGFAZ21haWwuY29tJztcbiAgICBpZiAobmFtZS5sZW5ndGggIT09IDAgJiYgcHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtcHdkLmxlbmd0aCAhPT0gMCAmJlxuICAgICAgZW1haWwubGVuZ3RoICE9PSAwICYmIHB3ZCA9PT0gY29uZmlybXB3ZCAmJiBuYW1lVmVyaWZpZXMpIHtcbiAgICAgICQucG9zdCgnL3NpZ251cCcsIHtcbiAgICAgICAgICB1c2VybmFtZTogbmFtZSxcbiAgICAgICAgICBwYXNzd29yZDogcHdkLFxuICAgICAgICAgIGVtYWlsOiBlbWFpbFxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlVGV4dC5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHRbMF0ubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dC5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHNob3dNZXNzYWdlKGRhdGEubXNnLCAnbXNnJyk7XG4gICAgICAgICAgJCgnLmJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgICQoJyNsb2dpbkxpbmsnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkaXNwbGF5U2VhcmNoQmFyKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAkKCcjaGVhZGVyRGl2JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJyNzZWFyY2gnKS5hZGRDbGFzcygnc2hvdycpO1xuXG4gICAgLyogaGlkZSByZXN0IG9mIGRhdGEgZm9yIHNlYXJjaCB2aWV3ICovXG4gICAgJCgnLmpzLW5vblNlYXJjaFZpZXcnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJy5qcy1zZWFyY2hWaWV3JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVTZWFyY2hCYXIoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoJycpO1xuICAgICQoJyNoZWFkZXJEaXYnKS5yZW1vdmVDbGFzcygnaGlkZScpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgJCgnI3NlYXJjaCcpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG5cbiAgICAvKiBzaG93IHJlc3Qgb2YgZGF0YSBhbmQgaGlkZSBzZWFyY2ggdmlldyovXG4gICAgJCgnLmpzLW5vblNlYXJjaFZpZXcnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICQoJy5qcy1zZWFyY2hWaWV3JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuanMtc2VhcmNoVmlldycpLmVtcHR5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93VXNlck1lbnVEKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdXNlckljb24gPSAkKCcjdXNlci1tZW51Jyk7XG4gICAgaWYgKCF1c2VySWNvbi5oYXNDbGFzcygnc2hvdycpKSB7XG4gICAgICAkKCcjdXNlci1tZW51JykuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnI3VzZXItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBzaG93VXNlck1lbnUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySWNvbiA9ICQoJyN1c2VyLW1lbnUnKTtcbiAgICAkKCcjdXNlci1tZW51JykuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICB1c2VySWNvbi5jc3MoJ3dpZHRoJywgJzI1MHB4Jyk7XG4gICAgdXNlckljb24ucHJlcGVuZCgnPGRpdiBjbGFzcz1cImNsb3NlLWljb25cIj48aSBjbGFzcz1cImZpLXhcIj48L2k+PC9kaXY+Jyk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlVXNlck1lbnUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySWNvbiA9ICQoJyN1c2VyLW1lbnUnKTtcbiAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICB1c2VySWNvbi5jc3MoJ3dpZHRoJywgJzE4MHB4Jyk7XG4gICAgJCgnLmNsb3NlLWljb24nKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoYW5nZVRyYWNrKGUpIHtcbiAgICAkKCcudHJhY2tMaXN0JykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICQoJy50cmFja0l0ZW0nKS5yZW1vdmVDbGFzcygnZmktc291bmQnKTtcbiAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAkKHRoaXMpLmZpbmQoJy50cmFja0l0ZW0nKS5hZGRDbGFzcygnZmktc291bmQnKTtcbiAgICBjb25zdCB0cmFja1NyYyA9ICQodGhpcykuZGF0YSgndHJhY2stc3JjJyk7XG4gICAgLy9jb25zdCBzdHIgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG4gICAgLy9jb25zdCBwYXRoID0gc3RyLnN1YnN0cigwLCBzdHIubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgLy9jb25zdCB0cmFja0lkID0gJCh0aGlzKS5hdHRyKCdpZCcpO1xuICAgIG1lZGlhRWxlLnNldFNyYyh0cmFja1NyYyk7XG4gICAgbWVkaWFFbGUubG9hZCgpO1xuICAgIG1lZGlhRWxlLnBsYXkoKTtcbiAgICAvL2hpc3RvcnkucHVzaFN0YXRlKHRyYWNrSWQsICcnLCBwYXRoICsgdHJhY2tJZCk7XG4gIH1cblxuICAvKipcbiAgICogb24gcG9wc3RhdGUgaGlnaGxpZ2h0IHRoZSBwcm9wZXIgdHJhY2tcbiAgICovXG4gIC8vICQod2luZG93KS5vbigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XG4gIC8vICAgY29uc3QgdHJhY2tJZCA9IGUub3JpZ2luYWxFdmVudC5zdGF0ZTtcbiAgLy8gICBpZiAodHJhY2tJZCAhPT0gbnVsbCkge1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHt0cmFja0lkfWApLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAvLyAgICAgJCgnLnRyYWNrTGlzdCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgLy8gICAgICQoJy50cmFja0l0ZW0nKS5yZW1vdmVDbGFzcygnZmktc291bmQnKTtcbiAgLy8gICAgICQoYCMke3RyYWNrSWR9YCkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAvLyAgICAgJChgIyR7dHJhY2tJZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBjb25zdCBzdHIgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG4gIC8vICAgICBjb25zdCBpZCA9IHN0ci5zdWJzdHIoc3RyLmxhc3RJbmRleE9mKFwiL1wiKSArIDEsIHN0ci5sZW5ndGgpO1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHtpZH1gKS5kYXRhKCd0cmFjay1zcmMnKTtcbiAgLy8gICAgICQoJy50cmFja0xpc3QnKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH1cbiAgLy8gfSk7XG5cbiAgLyoqXG4gICAqIFNlYXJjaFxuICAgKi9cbiAgZnVuY3Rpb24gY2FsbFNlYXJjaChlKSB7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgIHNlYXJjaChlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZWFyY2goZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKCcuanMtc2VhcmNoVmlldycpLmVtcHR5KCk7XG4gICAgdmFyIHNlYXJjaFN0cmluZyA9ICQudHJpbSgkKCcjc2VhcmNoLXRleHQnKS52YWwoKSk7IC8qIHRyaW0gYmVnaW5uaW5nIGFuZCBlbmRpbmcgc3BhY2VzICovXG4gICAgc2VhcmNoU3RyaW5nID0gc2VhcmNoU3RyaW5nLnJlcGxhY2UoL1xccysvZywgJyAnKTtcbiAgICBpZihzZWFyY2hTdHJpbmcubGVuZ3RoID4gMCAmJiBzZWFyY2hTdHJpbmcgIT09ICcgJykge1xuICAgICAgY29uc29sZS5sb2coJ2hlcmUnK3NlYXJjaFN0cmluZylcbiAgICAgICQucG9zdChgL3NlYXJjaC8ke3NlYXJjaFN0cmluZ31gKVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZGF0YSlcbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICQoJyNzZWFyY2hDb250JykuaHRtbChkYXRhKTtcbiAgICAgICAgICAkKCcjanMtc2VhcmNoUmVzdWx0cycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG5cbiAgfVxuXG4gIC8qKlxuICAgKiBVdGlsaXR5IGZ1bmN0aW9uc1xuICAgKi9cblxuICBmdW5jdGlvbiBjbGVhck1lc3NhZ2UoKSB7XG4gICAgJCgnI2Vycm9yJykuZW1wdHkoKTtcbiAgICAkKCcjbXNnJykuZW1wdHkoKTtcbiAgICAkKCcjZW1wdHlGaWVsZHMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICQoJy5pY29uLWVycm9yJykucmVtb3ZlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93TWVzc2FnZShtc2dUeHQsIG1zZ0Rpdikge1xuICAgIHZhciB1bEVsZSA9ICQoJyNtc2djb250Jyk7XG4gICAgaWYgKHVsRWxlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdWxFbGUgPSAkKCc8dWwgaWQ9XFwnbXNnY29udFxcJz48L3VsPicpO1xuICAgIH1cbiAgICB1bEVsZS5hcHBlbmQoJzxsaT4nICsgbXNnVHh0ICsgJzwvbGk+Jyk7XG4gICAgJCgnIycgKyBtc2dEaXYpLmh0bWwodWxFbGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd0Vycm9yQ2lyY2xlKGNpcmNsZUlucCkge1xuICAgIGNvbnN0IGlucEVsZSA9ICQoJyMnICsgY2lyY2xlSW5wKTtcbiAgICBjb25zdCBzcGFuRWxlID0gJCgnPHNwYW4gY2xhc3M9XFwnaWNvbi1lcnJvclxcJz48aSBjbGFzcz1cXCdmaS14LWNpcmNsZVxcJz48L2k+PC9zcGFuPicpO1xuICAgIGlucEVsZS5hZnRlcihzcGFuRWxlKTtcbiAgfVxuXG5cblxuXG59KCkpO1xuIl19
