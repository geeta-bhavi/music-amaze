"use strict";$(function(){var e=null;function s(e){$.post("/update/playCount/"+e).fail(function(e){console.log(e)}).done(function(e){console.log(e)})}function t(){0===$("li.trackList.highlight").prev().length?$("#trackPrev").addClass("inactive"):$("#trackPrev").removeClass("inactive"),0===$("li.trackList.highlight").next().length?$("#trackNext").addClass("inactive"):$("#trackNext").removeClass("inactive"),0===$("li.trackList.highlight").prev().length&&0===$("li.trackList.highlight").next().length&&$("#trackShuffle").addClass("inactive")}$(document).foundation(),$(".screenText").slick({dots:!0,infinite:!0,speed:500,fade:!0,cssEase:"linear"}),window.location.pathname.indexOf("play")&&$("#audioPlayer").mediaelementplayer({stretching:"responsive",pluginPath:"../js/lib/build/",success:function(a,n,r){e=a,t(),e.play(),$(e).on("playing",function(){s($("li.trackList.highlight").attr("id")),$(e).off("playing")}),$(a).on("ended",function(){if($("#trackShuffle").hasClass("active")){var n=$("li.trackList").length,r=Math.floor(Math.random()*n+1);(i=$("li.trackList:nth-child("+r+")")).hasClass("highlight")&&0===(i=i.next()).length&&(i=$("li.trackList:nth-child(1)")),i.click()}else{var i=$("li.trackList.highlight").next();if($("#trackRepeat").hasClass("active"))a.play(),s($("li.trackList.highlight").attr("id"));else 0===i.length?(!function(t){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),t.addClass("highlight"),t.find(".trackItem").addClass("fi-sound");var a=t.data("track-src");e.setSrc(a),e.load(),$(e).on("playing",function(){var a=t.attr("id");s(a),$(e).off("playing")})}($("li.trackList").first()),t()):i.click()}})},error:function(e,s){alert("There is some error at the server playing the track!")}}),$(window).on("load resize",function(){$("#footer");$(".title-bar").is(":visible")?$("#index-menu").removeClass("addFloat"):$("#index-menu").addClass("addFloat");$(window).width()<400?($(".menuDiv").addClass("menuMode"),$("#user-menu").addClass("menuMod"),$("#user-menu").removeClass("show")):($("#user-menu").removeClass("show"),$("#user-menu").css("width","180px"),$(".close-icon").remove(),$(".menuDiv").removeClass("menuMode"),$("#user-menu").removeClass("menuMod"))}),$("#login").on("submit",function(e){e.preventDefault(),c();var s=$("#userName").val(),t=$("#userPassword").val();if(0!==s.length&&0!==t.length){var a=/^[a-zA-Z0-9._]{1,30}$/.test(s);a?$.post("/login",{username:s,password:t}).fail(function(e){var s=e.responseJSON;400===e.status&&d(s[0].msg,"error"),401===e.status&&d(s.msg,"error")}).done(function(e){window.location.href="/user/home"}):(h("userName"),d("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(h("userName"),$("#emptyFields").removeClass("hide")),0==t.length&&(h("userPassword"),$("#emptyFields").removeClass("hide"))}),$("#editProfile").on("submit",function(e){e.preventDefault(),c();var s=$("#userName").val(),t=$("#email").val();if(0!==s.length&&0!==t.length){var a=/^[a-zA-Z0-9._]{1,30}$/.test(s);a?$.post("/user/editProfile",{username:s,email:t}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?d(s[0].msg,"error"):d(s.msg,"error")}}).done(function(e){d(e.msg,"msg"),$("#loginLink").removeClass("hide"),$(".btns").addClass("hide")}):(h("userName"),d("Usernames can only use letters, numbers, underscores and periods.","error"))}else 0===s.length&&(h("userName"),$("#emptyFields").removeClass("hide")),0==t.length&&(h("email"),$("#emptyFields").removeClass("hide"))}),$("#confirmUser").on("submit",function(e){e.preventDefault(),c();var s=$("#username").val();0!==s.length?$.post("/verifyUser",{username:s}).fail(function(e){if(401===e.status){var s=e.responseJSON;d(s.msg,"error")}}).done(function(e){$("#username").val(""),$("#forgotPassword").removeClass("hide"),$("#confirmUser").addClass("hide"),a=e}):0===s.length&&(h("username"),$("#emptyFields").removeClass("hide"))}),$("#forgotPassword").on("submit",function(e){e.preventDefault(),c();var s=$("#newPassword").val(),t=$("#confirmPassword").val();0===s.length&&(h("newPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(h("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==s.length&&t!==s&&(h("confirmPassword"),$("#emptyFields").addClass("hide"),d("Confirm password doesn't match with the new password","error"));0!==s.length&&0!==t.length&&s===t&&$.post("/forgotPassword",{newPassword:s,user:a}).fail(function(e){if(400===e.status){var s=e.responseJSON;d(s.msg,"error")}}).done(function(e){d(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#signup").on("submit",function(e){e.preventDefault(),c();var s=$("#userName").val(),t=$("#userEmail").val(),a=$("#userPassword").val(),n=$("#confirmPassword").val(),r=/^[a-zA-Z0-9._]{1,30}$/.test(s);0===s.length&&(h("userName"),$("#emptyFields").removeClass("hide"));r||0===s.length||(h("userName"),d("Usernames can only use letters, numbers, underscores and periods.","error"));0===t.length&&(h("userEmail"),$("#emptyFields").removeClass("hide"));0===a.length&&(h("userPassword"),$("#emptyFields").removeClass("hide"));0===n.length&&(h("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==a.length&&0!==n.length&&n!==a&&(h("confirmPassword"),$("#emptyFields").addClass("hide"),d("Confirm password doesn't match with password","error"),0!==t.length&&0!==s.length||$("#emptyFields").removeClass("hide"));0!==s.length&&0!==a.length&&0!==n.length&&0!==t.length&&a===n&&r&&$.post("/signup",{username:s,password:a,email:t}).fail(function(e){if(400===e.status){var s=e.responseJSON;s.length>=1?d(s[0].msg,"error"):d(s.msg,"error")}}).done(function(e){d(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#reset").on("click",c),$("#changePassword").on("submit",function(e){e.preventDefault(),c();var s=$("#oldPassword").val(),t=$("#newPassword").val(),a=$("#confirmPassword").val();0===s.length&&(h("oldPassword"),$("#emptyFields").removeClass("hide"));0===t.length&&(h("newPassword"),$("#emptyFields").removeClass("hide"));0===a.length&&(h("confirmPassword"),$("#emptyFields").removeClass("hide"));0!==t.length&&0!==a.length&&a!==t&&(h("confirmPassword"),$("#emptyFields").addClass("hide"),d("Confirm password doesn't match with the new password","error"),0===s.length&&$("#emptyFields").removeClass("hide"));0!==s.length&&0!==t.length&&0!==a.length&&t===a&&$.post("/user/changePassword",{oldPassword:s,newPassword:t}).fail(function(e){if(400===e.status){var s=e.responseJSON;d(s.msg,"error")}}).done(function(e){d(e.msg,"msg"),$(".btns").addClass("hide"),$("#loginLink").removeClass("hide")})}),$("#searchIcon").on("click",n),$(".js-search-close").on("click",function(e){e.preventDefault(),$("#search-text").val(""),$("#headerDiv").removeClass("hide").addClass("show"),$("#search").removeClass("show"),$(".js-nonSearchView").removeClass("hide"),$(".js-searchView").addClass("hide"),-1===window.location.pathname.indexOf("user")&&(window.location.pathname="/user/home")}),$(".menuDiv").on("click",function(e){e.preventDefault(),$("#user-menu").hasClass("show")?$("#user-menu").removeClass("show"):$("#user-menu").addClass("show")}),$(".trackList").on("click",function(a){if(!$(this).hasClass("highlight")){$(".trackList").removeClass("highlight"),$(".trackItem").removeClass("fi-sound"),$(this).addClass("highlight"),$(this).find(".trackItem").addClass("fi-sound");var n=$(this).data("track-src");e.setSrc(n),e.load(),e.play(),t();var r=$(this).attr("id");s(r)}}),$("#search-text").on("keyup",function(e){13===e.keyCode&&r(e)}),$(".js-search-icon").on("click",r),$("#trackRepeat").on("click",l),$("#trackLike").on("click",l),$("#trackPrev").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||($("li.trackList.highlight").prev().click(),t())}),$("#trackNext").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||($("li.trackList.highlight").next().click(),t())}),$("#trackShuffle").on("click",function(e){e.preventDefault(),$(this).hasClass("inactive")||$(this).toggleClass("active")}),$(".playListCreate").on("click",function(e){e.preventDefault()}),$(document).on("click",".menuMode",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").addClass("show"),s.css("width","250px"),s.prepend('<div class="close-icon"><i class="fi-x"></i></div>')}),$(document).on("click",".close-icon",function(e){e.preventDefault();var s=$("#user-menu");$("#user-menu").removeClass("show"),s.css("width","180px"),$(".close-icon").remove()}),$(document).on("click",".seeAllR",o);var a=null;function n(e){e&&e.preventDefault(),$("#headerDiv").removeClass("show").addClass("hide"),$("#search").addClass("show"),$(".js-nonSearchView").addClass("hide"),$(".js-searchView").removeClass("hide")}function r(e,s,t){null!==e&&e.preventDefault(),$(".js-searchView").empty();var a=void 0!==s?s:$.trim($("#search-text").val());a=a.replace(/\s+/g," "),(a=encodeURIComponent(a)).length>0&&" "!==a&&$.post("/search/"+a).fail(function(e){console.log(e),$("#searchCont").html(e)}).done(function(e){if($("#searchCont").html(e),$("#js-searchResults").removeClass("hide"),void 0===t){var s="/search/"+a;history.pushState({search:decodeURIComponent(a)},"",s)}})}if(null!==window.history.state){var i=window.history.state;void 0!==i.search&&void 0===i.category?(n(),$("#search-text").val(i.search),r(null,i.search,"noPopstate")):void 0!==i.search&&void 0!==i.category&&(n(),$("#search-text").val(i.search),o(null,i.search,i.category,"noPopstate"))}function o(e,s,t,a){null!==e&&e.preventDefault();var n=void 0!==s?s:$(".searchStr").html(),r=void 0!==t?t:$(this).data("category");n=encodeURIComponent(n),$.post("/search/"+r+"/"+n).fail(function(e){$("#searchCont").html(e)}).done(function(e){if($("#searchCont").html(e),$("#js-searchResults").removeClass("hide"),void 0===a){var s="/search/"+r+"/"+n;history.pushState({search:decodeURIComponent(n),category:r},"",s)}})}function l(e){e.preventDefault(),$(this).toggleClass("active")}function c(){$("#error").empty(),$("#msg").empty(),$("#emptyFields").addClass("hide"),$(".icon-error").remove()}function d(e,s){var t=$("#msgcont");0===t.length&&(t=$("<ul id='msgcont'></ul>")),t.append("<li>"+e+"</li>"),$("#"+s).html(t)}function h(e){var s=$("#"+e),t=$("<span class='icon-error'><i class='fi-x-circle'></i></span>");s.after(t)}$(window).on("popstate",function(e){var s=e.originalEvent.state;if(null===s){var t=window.location.href;window.location.href=t}else void 0!==s.search&&void 0===s.category?(n(e),$("#search-text").val(s.search),r(e,s.search,"noPopstate")):void 0!==s.search&&void 0!==s.category&&(n(e),$("#search-text").val(s.search),o(e,s.search,s.category,"noPopstate"))})}());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsIm1lZGlhRWxlIiwidXBkYXRlTm9PZlBsYXlzIiwidHJhY2tJZCIsImNvbnNvbGUiLCJmYWlsIiwiZG9uZSIsImRhdGEiLCJsb2ciLCJoaWdoTGlnaHRQcmV2TmV4dCIsInByZXYiLCJsZW5ndGgiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwibmV4dCIsImxpRWxlIiwiZG9jdW1lbnQiLCJmb3VuZGF0aW9uIiwic2xpY2siLCJkb3RzIiwiaW5maW5pdGUiLCJzcGVlZCIsIndpbmRvdyIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJpbmRleE9mIiwibWVkaWFlbGVtZW50cGxheWVyIiwicGx1Z2luUGF0aCIsInN1Y2Nlc3MiLCJtZWRpYUVsZW1lbnQiLCJvcmlnaW5hbE5vZGUiLCJpbnN0YW5jZSIsInBsYXkiLCJhdHRyIiwib24iLCJoYXNDbGFzcyIsImxpQ291bnQiLCJmbG9vciIsIk1hdGgiLCJyYW5kb20iLCJjbGljayIsImNhbGxGb2N1cyIsImZpbmQiLCJ0cmFja1NyYyIsInNldFNyYyIsIm9mZiIsImFsZXJ0Iiwid2lkdGgiLCJpcyIsImNzcyIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImNsZWFyTWVzc2FnZSIsIm5hbWUiLCJ2YWwiLCJuYW1lVmVyaWZpZXMiLCJ1c2VybmFtZSIsInB3ZCIsInBhc3N3b3JkIiwidGVzdCIsInNob3dNZXNzYWdlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2VKU09OIiwibXNnIiwic2hvd0Vycm9yQ2lyY2xlIiwiaHJlZiIsImhhbmRsZVVwZGF0ZVByb2ZpbGUiLCJlbWFpbCIsInBvc3QiLCJoYW5kbGVVcGRhdGVQYXNzd29yZCIsIm5ld1B3ZCIsImNvbmZpcm1Qd2QiLCJuZXdQYXNzd29yZCIsImhhbmRsZUNoYW5nZVBhc3N3b3JkIiwib2xkUHdkIiwiY29uZmlybXB3ZCIsImhhbmRsZVNpZ25VcCIsInVzZXJOYW1lUmVnZXgiLCJkaXNwbGF5U2VhcmNoQmFyIiwidXNlckljb24iLCJwcmVwZW5kIiwidGhpcyIsImxvYWQiLCJrZXlDb2RlIiwic2VhcmNoIiwicGxheU5leHQiLCJsaW5rQWN0aXZlIiwicGxheVByZXZpb3VzIiwicmVtb3ZlIiwic2VlQWxsUmVzdWx0cyIsInVzZXIiLCJzdHIiLCJwb3BzdGF0ZSIsInNlYXJjaFN0cmluZyIsInN0YXRlIiwidHJpbSIsInJlcGxhY2UiLCJ1bmRlZmluZWQiLCJodG1sIiwib3JpZ2luYWxFdmVudCIsImhpc3RvcnkiLCJwdXNoU3RhdGUiLCJkZWNvZGVVUklDb21wb25lbnQiLCJwYXRoIiwiY2F0ZWdvcnkiLCJzcmNoU3RyIiwiY3JlYXRlUGxheWxpc3QiLCJjYXRlZ3J5Iiwic2VhcmNoU3RyIiwidWxFbGUiLCJtc2dUeHQiLCJhcHBlbmQiLCJtc2dEaXYiLCJpbnBFbGUiLCJhZnRlciIsInNwYW5FbGUiLCJ0b2dnbGVDbGFzcyIsImVtcHR5IiwiY2lyY2xlSW5wIl0sIm1hcHBpbmdzIjoiYUFBQUEsRUFBRSxXQUFBLElBQUFDLEVBQVcsS0F1RlRELFNBQUFFLEVBQUFDLEdBRUVDLEVBQUFBLEtBQUFBLHFCQUFBRCxHQUZGRSxLQUlDQyxTQUFLQyxHQUNKSCxRQUFRSSxJQUFJRCxLQUdmRCxLQUFBLFNBQUFDLEdBSEdILFFBQVFJLElBQUlELEtBa0NaUCxTQUFFUyxJQUNILElBQUFULEVBQUEsMEJBQUFVLE9BQUFDLE9BQ0RYLEVBQUlBLGNBQUVZLFNBQUEsWUFBTlosRUFBQSxjQUVPYSxZQUFBLFlBRU4sSUFBQWIsRUFBQSwwQkFBQWMsT0FBQUgsT0FIQ1gsRUFBRSxjQUFjWSxTQUFTLFlBTXpCWixFQUFFLGNBQUFhLFlBQTBCLFlBRG9CLElBQTlDYixFQUFFLDBCQUEwQlUsT0FBT0MsUUFBOEQsSUFBOUNYLEVBQUUsMEJBQTBCYyxPQUFPSCxRQUs1RlgsRUFBQSxpQkFBbUJlLFNBQU8sWUFwSTFCZixFQUFFZ0IsVUFBVUMsYUFLWmpCLEVBQUUsZUFBZWtCLE9BQ2ZDLE1BQU0sRUFETkMsVUFBQSxFQUNBRCxN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LElBQUUrRixFQUFBN0MsRUFBQWtELGNBQXFCdkYsTUFFckIsR0FBTStFLE9BQU5HLEVBQU1ILENBQ05TLElBQUFBLEVBQVFDLE9BQVUvRSxTQUFBMkMsS0FDaEJtQixPQUFBQSxTQUFRa0IsS0FBQUEsWUFDRUUsSUFBVkEsRUFBVUEsYUFBQUEsSUFBQUEsRUFBQUEsVUFGTTFCLEVBQWxCN0IsR0FJRGxELEVBQUEsZ0JBQUFzRCxJQUFBeUMsRUFBQVYsUUFiTEEsRUFBQW5DLEVBQUE2QyxFQUFBVixPQUFBLG9CQWVEYSxJQUFBSCxFQUFBVixhQUFBYSxJQUFBSCxFQUFBVSxXQS9CRzFCLEVBQWlCN0IsR0FpQ3JCbEQsRUFBQSxnQkFBQXNELElBQXVCeUMsRUFBQVYsUUFDbkJsQyxFQUFGRCxFQUFBNkMsRUFBQVYsT0FBQVUsRUFBQVUsU0FBQSxpQkFodEJGIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uKCkge1xuXG4gIHZhciBtZWRpYUVsZSA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgZm91bmRhdGlvblxuICAgKi9cbiAgJChkb2N1bWVudCkuZm91bmRhdGlvbigpO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHNsaWRlclxuICAgKi9cbiAgJCgnLnNjcmVlblRleHQnKS5zbGljayh7XG4gICAgZG90czogdHJ1ZSxcbiAgICBpbmZpbml0ZTogdHJ1ZSxcbiAgICBzcGVlZDogNTAwLFxuICAgIGZhZGU6IHRydWUsXG4gICAgY3NzRWFzZTogJ2xpbmVhcidcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYXVkaW8gcGxheWVyXG4gICAqL1xuICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoJ3BsYXknKSkge1xuICAgICQoJyNhdWRpb1BsYXllcicpLm1lZGlhZWxlbWVudHBsYXllcih7XG4gICAgICBzdHJldGNoaW5nOiAncmVzcG9uc2l2ZScsXG4gICAgICBwbHVnaW5QYXRoOiAnLi4vanMvbGliL2J1aWxkLycsXG4gICAgICAvLyBXaGVuIHVzaW5nIGpRdWVyeSdzIGBtZWRpYWVsZW1lbnRwbGF5ZXJgLCBhbiBgaW5zdGFuY2VgIGFyZ3VtZW50XG4gICAgICAvLyBpcyBhdmFpbGFibGUgaW4gdGhlIGBzdWNjZXNzYCBjYWxsYmFja1xuICAgICAgc3VjY2VzczogZnVuY3Rpb24obWVkaWFFbGVtZW50LCBvcmlnaW5hbE5vZGUsIGluc3RhbmNlKSB7XG4gICAgICAgIG1lZGlhRWxlID0gbWVkaWFFbGVtZW50O1xuICAgICAgICBoaWdoTGlnaHRQcmV2TmV4dCgpO1xuXG4gICAgICAgIG1lZGlhRWxlLnBsYXkoKTtcblxuICAgICAgICAkKG1lZGlhRWxlKS5vbigncGxheWluZycsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB0cmFja0lkID0gJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLmF0dHIoJ2lkJyk7XG4gICAgICAgICAgdXBkYXRlTm9PZlBsYXlzKHRyYWNrSWQpO1xuICAgICAgICAgICQobWVkaWFFbGUpLm9mZigncGxheWluZycpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICAkKG1lZGlhRWxlbWVudCkub24oJ2VuZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKCQoJyN0cmFja1NodWZmbGUnKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpQ291bnQgPSAkKCdsaS50cmFja0xpc3QnKS5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCByYW5kb20gPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogbGlDb3VudCkgKyAxKTtcbiAgICAgICAgICAgIHZhciBsaUVsZSA9ICQoJ2xpLnRyYWNrTGlzdDpudGgtY2hpbGQoJyArIHJhbmRvbSArICcpJyk7XG5cblxuICAgICAgICAgICAgaWYgKGxpRWxlLmhhc0NsYXNzKCdoaWdobGlnaHQnKSkge1xuICAgICAgICAgICAgICBsaUVsZSA9IGxpRWxlLm5leHQoKTtcbiAgICAgICAgICAgICAgaWYgKGxpRWxlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGxpRWxlID0gJCgnbGkudHJhY2tMaXN0Om50aC1jaGlsZCgxKScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpRWxlLmNsaWNrKCk7XG5cbiAgICAgICAgICAgIC8vdXBkYXRlIHBsYXkgY291bnRcbiAgICAgICAgICAgIC8vIGNvbnN0IHRyYWNrSWQgPSAkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykuYXR0cignaWQnKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZU5vT2ZQbGF5cyh0cmFja0lkKTtcblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbGlFbGUgPSAkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykubmV4dCgpO1xuXG4gICAgICAgICAgICBpZiAoJCgnI3RyYWNrUmVwZWF0JykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICAgICAgIG1lZGlhRWxlbWVudC5wbGF5KCk7XG4gICAgICAgICAgICAgIC8vdXBkYXRlIHBsYXkgY291bnRcbiAgICAgICAgICAgICAgY29uc3QgdHJhY2tJZCA9ICQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5hdHRyKCdpZCcpO1xuICAgICAgICAgICAgICB1cGRhdGVOb09mUGxheXModHJhY2tJZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAobGlFbGUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY2FsbEZvY3VzKCQoJ2xpLnRyYWNrTGlzdCcpLmZpcnN0KCkpO1xuICAgICAgICAgICAgICAgIGhpZ2hMaWdodFByZXZOZXh0KCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGlFbGUuY2xpY2soKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1lZGlhRWxlbWVudCwgb3JpZ2luYWxOb2RlKSB7XG4gICAgICAgIGFsZXJ0KCdUaGVyZSBpcyBzb21lIGVycm9yIGF0IHRoZSBzZXJ2ZXIgcGxheWluZyB0aGUgdHJhY2shJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVOb09mUGxheXModHJhY2tJZCkge1xuICAgICQucG9zdChgL3VwZGF0ZS9wbGF5Q291bnQvJHt0cmFja0lkfWApXG4gICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgfSlcbiAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgIH0pO1xuXG4gIH1cblxuICBmdW5jdGlvbiBzaHVmZmxlVHJhY2tzKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdpbmFjdGl2ZScpKSB7XG4gICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5UHJldmlvdXMoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2luYWN0aXZlJykpIHtcbiAgICAgIHZhciBsaUVsZSA9ICQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5wcmV2KCk7XG4gICAgICBsaUVsZS5jbGljaygpO1xuICAgICAgaGlnaExpZ2h0UHJldk5leHQoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5TmV4dChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnaW5hY3RpdmUnKSkge1xuICAgICAgdmFyIGxpRWxlID0gJCgnbGkudHJhY2tMaXN0LmhpZ2hsaWdodCcpLm5leHQoKTtcbiAgICAgIGxpRWxlLmNsaWNrKCk7XG4gICAgICBoaWdoTGlnaHRQcmV2TmV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZ2hMaWdodFByZXZOZXh0KCkge1xuICAgIGlmICgkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykucHJldigpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJCgnI3RyYWNrUHJldicpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjdHJhY2tQcmV2JykucmVtb3ZlQ2xhc3MoJ2luYWN0aXZlJyk7XG4gICAgfVxuICAgIGlmICgkKCdsaS50cmFja0xpc3QuaGlnaGxpZ2h0JykubmV4dCgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJCgnI3RyYWNrTmV4dCcpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjdHJhY2tOZXh0JykucmVtb3ZlQ2xhc3MoJ2luYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgaWYgKCQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5wcmV2KCkubGVuZ3RoID09PSAwICYmICQoJ2xpLnRyYWNrTGlzdC5oaWdobGlnaHQnKS5uZXh0KCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAkKCcjdHJhY2tTaHVmZmxlJykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2FsbEZvY3VzKGxpRWxlKSB7XG4gICAgJCgnLnRyYWNrTGlzdCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gICAgbGlFbGUuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgIGxpRWxlLmZpbmQoJy50cmFja0l0ZW0nKS5hZGRDbGFzcygnZmktc291bmQnKTtcbiAgICBjb25zdCB0cmFja1NyYyA9IGxpRWxlLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAgIC8vIGNvbnN0IHN0ciA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcbiAgICAvLyBjb25zdCBwYXRoID0gc3RyLnN1YnN0cigwLCBzdHIubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgLy8gY29uc3QgdHJhY2tJZCA9IGxpRWxlLmF0dHIoJ2lkJyk7XG4gICAgbWVkaWFFbGUuc2V0U3JjKHRyYWNrU3JjKTtcbiAgICBtZWRpYUVsZS5sb2FkKCk7XG4gICAgLy9oaXN0b3J5LnB1c2hTdGF0ZSh0cmFja0lkLCAnJywgcGF0aCArIHRyYWNrSWQpO1xuICAgICQobWVkaWFFbGUpLm9uKCdwbGF5aW5nJywgKCkgPT4ge1xuICAgICAgLy91cGRhdGUgcGxheSBjb3VudFxuICAgICAgY29uc3QgdHJhY2tJZCA9IGxpRWxlLmF0dHIoJ2lkJyk7XG4gICAgICB1cGRhdGVOb09mUGxheXModHJhY2tJZCk7XG4gICAgICAkKG1lZGlhRWxlKS5vZmYoJ3BsYXlpbmcnKTtcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGZ1bmN0aW9uc1xuICAgKi9cbiAgJCh3aW5kb3cpLm9uKCdsb2FkIHJlc2l6ZScsIGhhbmRsZUxvYWQpO1xuICAkKCcjbG9naW4nKS5vbignc3VibWl0JywgaGFuZGxlTG9naW4pOyAvKiBvbiBsb2dpbiAqL1xuICAkKCcjZWRpdFByb2ZpbGUnKS5vbignc3VibWl0JywgaGFuZGxlVXBkYXRlUHJvZmlsZSk7IC8qIHVwZGF0ZSBwcm9maWxlICovXG4gICQoJyNjb25maXJtVXNlcicpLm9uKCdzdWJtaXQnLCBoYW5kbGVWZXJpZnlVc2VyKTsgLyogdmVyaWZ5IHVzZXIgKi9cbiAgJCgnI2ZvcmdvdFBhc3N3b3JkJykub24oJ3N1Ym1pdCcsIGhhbmRsZVVwZGF0ZVBhc3N3b3JkKTsgLyogcG9zdCB1cGRhdGUgcGFzc3dvcmQgKi9cbiAgJCgnI3NpZ251cCcpLm9uKCdzdWJtaXQnLCBoYW5kbGVTaWduVXApOyAvKiBTaWduIHVwICovXG4gICQoJyNyZXNldCcpLm9uKCdjbGljaycsIGNsZWFyTWVzc2FnZSk7IC8qIENsZWFyIG1lc3NhZ2VzIG9uIGNsaWNrIG9mIHJlc2V0ICovXG4gICQoJyNjaGFuZ2VQYXNzd29yZCcpLm9uKCdzdWJtaXQnLCBoYW5kbGVDaGFuZ2VQYXNzd29yZCk7IC8qIHBvc3QgY2hhbmdlIHBhc3N3b3JkICovXG4gICQoJyNzZWFyY2hJY29uJykub24oJ2NsaWNrJywgZGlzcGxheVNlYXJjaEJhcik7XG4gICQoJy5qcy1zZWFyY2gtY2xvc2UnKS5vbignY2xpY2snLCBoaWRlU2VhcmNoQmFyKTtcbiAgJCgnLm1lbnVEaXYnKS5vbignY2xpY2snLCBzaG93VXNlck1lbnVEKTtcbiAgJCgnLnRyYWNrTGlzdCcpLm9uKCdjbGljaycsIGNoYW5nZVRyYWNrKTsgLyogY2hhbmdlIHRyYWNrIG9uIGNsaWNrICovXG4gICQoJyNzZWFyY2gtdGV4dCcpLm9uKCdrZXl1cCcsIGNhbGxTZWFyY2gpOyAvKiBzZWFyY2ggZnVuY3Rpb25hbGl0eSAqL1xuICAkKCcuanMtc2VhcmNoLWljb24nKS5vbignY2xpY2snLCBzZWFyY2gpOyAvKiBzZWFyY2ggZnVuY3Rpb25hbGl0eSAqL1xuICAkKCcjdHJhY2tSZXBlYXQnKS5vbignY2xpY2snLCBsaW5rQWN0aXZlKTtcbiAgJCgnI3RyYWNrTGlrZScpLm9uKCdjbGljaycsIGxpbmtBY3RpdmUpO1xuICAkKCcjdHJhY2tQcmV2Jykub24oJ2NsaWNrJywgcGxheVByZXZpb3VzKTsgLyogcGxheSBwcmV2aW91cyB0cmFjayAqL1xuICAkKCcjdHJhY2tOZXh0Jykub24oJ2NsaWNrJywgcGxheU5leHQpOyAvKiBwbGF5IG5leHQgdHJhY2sgKi9cbiAgJCgnI3RyYWNrU2h1ZmZsZScpLm9uKCdjbGljaycsIHNodWZmbGVUcmFja3MpOyAvKiBzaHVmZmxlIHRyYWNrcyovXG4gICQoJy5wbGF5TGlzdENyZWF0ZScpLm9uKCdjbGljaycsIGNyZWF0ZVBsYXlsaXN0KTsgLyogQ3JlYXRlIHBsYXlsaXN0ICovXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcubWVudU1vZGUnLCBzaG93VXNlck1lbnUpO1xuICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNsb3NlLWljb24nLCBoaWRlVXNlck1lbnUpO1xuICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNlZUFsbFInLCBzZWVBbGxSZXN1bHRzKTsgLyogc2VlIGFsbCB0aGUgdHJhY2tzIG9mIHNlYXJjaCByZXN1bHRzICovXG5cblxuICB2YXIgdXNlciA9IG51bGw7XG5cblxuICAvKiBmdW5jdGlvbnMgKi9cbiAgZnVuY3Rpb24gaGFuZGxlTG9hZCgpIHtcbiAgICBjb25zdCBmb290ZXIgPSAkKCcjZm9vdGVyJyk7XG4gICAgaWYgKCQoJy50aXRsZS1iYXInKS5pcygnOnZpc2libGUnKSkge1xuICAgICAgJCgnI2luZGV4LW1lbnUnKS5yZW1vdmVDbGFzcygnYWRkRmxvYXQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnI2luZGV4LW1lbnUnKS5hZGRDbGFzcygnYWRkRmxvYXQnKTtcbiAgICB9XG4gICAgdmFyIHdpZHRoID0gJCh3aW5kb3cpLndpZHRoKCk7XG4gICAgaWYgKHdpZHRoIDwgNDAwKSB7XG4gICAgICAkKCcubWVudURpdicpLmFkZENsYXNzKCdtZW51TW9kZScpO1xuICAgICAgJCgnI3VzZXItbWVudScpLmFkZENsYXNzKCdtZW51TW9kJyk7XG4gICAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnI3VzZXItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAkKCcjdXNlci1tZW51JykuY3NzKCd3aWR0aCcsICcxODBweCcpO1xuICAgICAgJCgnLmNsb3NlLWljb24nKS5yZW1vdmUoKTtcbiAgICAgICQoJy5tZW51RGl2JykucmVtb3ZlQ2xhc3MoJ21lbnVNb2RlJyk7XG4gICAgICAkKCcjdXNlci1tZW51JykucmVtb3ZlQ2xhc3MoJ21lbnVNb2QnKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVMb2dpbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuICAgIGNvbnN0IG5hbWUgPSAkKCcjdXNlck5hbWUnKS52YWwoKTtcbiAgICBjb25zdCBwd2QgPSAkKCcjdXNlclBhc3N3b3JkJykudmFsKCk7XG5cbiAgICBpZiAobmFtZS5sZW5ndGggIT09IDAgJiYgcHdkLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgdXNlck5hbWVSZWdleCA9IC9eW2EtekEtWjAtOS5fXXsxLDMwfSQvO1xuICAgICAgY29uc3QgbmFtZVZlcmlmaWVzID0gdXNlck5hbWVSZWdleC50ZXN0KG5hbWUpO1xuXG4gICAgICBpZiAobmFtZVZlcmlmaWVzKSB7XG4gICAgICAgICQucG9zdCgnL2xvZ2luJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IG5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogcHdkXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLnJlc3BvbnNlSlNPTjtcbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dFswXS5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvdXNlci9ob21lJztcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgc2hvd01lc3NhZ2UoJ1VzZXJuYW1lcyBjYW4gb25seSB1c2UgbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMgYW5kIHBlcmlvZHMuJywgJ2Vycm9yJyk7XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuXG4gICAgICBpZiAobmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgICAgaWYgKHB3ZC5sZW5ndGggPT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJQYXNzd29yZCcpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZVByb2ZpbGUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgdXNlcm5hbWUgPSAkKCcjdXNlck5hbWUnKS52YWwoKTtcbiAgICBjb25zdCBlbWFpbCA9ICQoJyNlbWFpbCcpLnZhbCgpO1xuXG4gICAgaWYgKHVzZXJuYW1lLmxlbmd0aCAhPT0gMCAmJiBlbWFpbC5sZW5ndGggIT09IDApIHtcblxuICAgICAgY29uc3QgcGF0dGVybiA9IC9eW2EtekEtWjAtOS5fXXsxLDMwfSQvO1xuICAgICAgY29uc3QgbmFtZVZlcmlmaWVzID0gcGF0dGVybi50ZXN0KHVzZXJuYW1lKTtcbiAgICAgIGlmIChuYW1lVmVyaWZpZXMpIHtcbiAgICAgICAgJC5wb3N0KCcvdXNlci9lZGl0UHJvZmlsZScsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBlbWFpbFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICAgIGlmIChyZXNwb25zZVRleHQubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHRbMF0ubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YS5tc2csICdtc2cnKTtcbiAgICAgICAgICAgICQoJyNsb2dpbkxpbmsnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgJCgnLmJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyTmFtZScpO1xuICAgICAgICBzaG93TWVzc2FnZSgnVXNlcm5hbWVzIGNhbiBvbmx5IHVzZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyBhbmQgcGVyaW9kcy4nLCAnZXJyb3InKTtcblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodXNlcm5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNob3dFcnJvckNpcmNsZSgndXNlck5hbWUnKTtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgIGlmIChlbWFpbC5sZW5ndGggPT0gMCkge1xuICAgICAgICBzaG93RXJyb3JDaXJjbGUoJ2VtYWlsJyk7XG4gICAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlVmVyaWZ5VXNlcihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY2xlYXJNZXNzYWdlKCk7XG5cbiAgICBjb25zdCB1c2VybmFtZSA9ICQoJyN1c2VybmFtZScpLnZhbCgpO1xuXG4gICAgaWYgKHVzZXJuYW1lLmxlbmd0aCAhPT0gMCkge1xuXG4gICAgICAkLnBvc3QoJy92ZXJpZnlVc2VyJywge1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgJCgnI3VzZXJuYW1lJykudmFsKCcnKTtcbiAgICAgICAgICAkKCcjZm9yZ290UGFzc3dvcmQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICQoJyNjb25maXJtVXNlcicpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgdXNlciA9IGRhdGE7XG4gICAgICAgIH0pO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh1c2VybmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VybmFtZScpO1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZVBhc3N3b3JkKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY2xlYXJNZXNzYWdlKCk7XG5cbiAgICBjb25zdCBuZXdQd2QgPSAkKCcjbmV3UGFzc3dvcmQnKS52YWwoKTtcbiAgICBjb25zdCBjb25maXJtUHdkID0gJCgnI2NvbmZpcm1QYXNzd29yZCcpLnZhbCgpO1xuXG4gICAgaWYgKG5ld1B3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnbmV3UGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpcm1Qd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtUHdkICE9PSBuZXdQd2QpIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgc2hvd01lc3NhZ2UoJ0NvbmZpcm0gcGFzc3dvcmQgZG9lc25cXCd0IG1hdGNoIHdpdGggdGhlIG5ldyBwYXNzd29yZCcsICdlcnJvcicpO1xuICAgIH1cblxuICAgIGlmIChuZXdQd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1Qd2QubGVuZ3RoICE9PSAwICYmIG5ld1B3ZCA9PT0gY29uZmlybVB3ZCkge1xuICAgICAgJC5wb3N0KCcvZm9yZ290UGFzc3dvcmQnLCB7XG4gICAgICAgICAgbmV3UGFzc3dvcmQ6IG5ld1B3ZCxcbiAgICAgICAgICB1c2VyOiB1c2VyXG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBzaG93TWVzc2FnZShyZXNwb25zZVRleHQubXNnLCAnZXJyb3InKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBzaG93TWVzc2FnZShkYXRhLm1zZywgJ21zZycpO1xuICAgICAgICAgICQoJy5idG5zJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcjbG9naW5MaW5rJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ2hhbmdlUGFzc3dvcmQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjbGVhck1lc3NhZ2UoKTtcblxuICAgIGNvbnN0IG9sZFB3ZCA9ICQoJyNvbGRQYXNzd29yZCcpLnZhbCgpO1xuICAgIGNvbnN0IG5ld1B3ZCA9ICQoJyNuZXdQYXNzd29yZCcpLnZhbCgpO1xuICAgIGNvbnN0IGNvbmZpcm1Qd2QgPSAkKCcjY29uZmlybVBhc3N3b3JkJykudmFsKCk7XG5cbiAgICBpZiAob2xkUHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdvbGRQYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCduZXdQYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlybVB3ZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmIChuZXdQd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1Qd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1Qd2QgIT09IG5ld1B3ZCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCdjb25maXJtUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICBzaG93TWVzc2FnZSgnQ29uZmlybSBwYXNzd29yZCBkb2VzblxcJ3QgbWF0Y2ggd2l0aCB0aGUgbmV3IHBhc3N3b3JkJywgJ2Vycm9yJyk7XG4gICAgICBpZiAob2xkUHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvbGRQd2QubGVuZ3RoICE9PSAwICYmIG5ld1B3ZC5sZW5ndGggIT09IDAgJiYgY29uZmlybVB3ZC5sZW5ndGggIT09IDAgJiYgbmV3UHdkID09PSBjb25maXJtUHdkKSB7XG4gICAgICAkLnBvc3QoJy91c2VyL2NoYW5nZVBhc3N3b3JkJywge1xuICAgICAgICAgIG9sZFBhc3N3b3JkOiBvbGRQd2QsXG4gICAgICAgICAgbmV3UGFzc3dvcmQ6IG5ld1B3ZFxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSA0MDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEucmVzcG9uc2VKU09OO1xuICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YS5tc2csICdtc2cnKTtcbiAgICAgICAgICAkKCcuYnRucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgJCgnI2xvZ2luTGluaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG5cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVNpZ25VcChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNsZWFyTWVzc2FnZSgpO1xuXG4gICAgY29uc3QgbmFtZSA9ICQoXCIjdXNlck5hbWVcIikudmFsKCk7XG4gICAgY29uc3QgZW1haWwgPSAkKFwiI3VzZXJFbWFpbFwiKS52YWwoKTtcbiAgICBjb25zdCBwd2QgPSAkKFwiI3VzZXJQYXNzd29yZFwiKS52YWwoKTtcbiAgICBjb25zdCBjb25maXJtcHdkID0gJChcIiNjb25maXJtUGFzc3dvcmRcIikudmFsKCk7XG4gICAgY29uc3QgdXNlck5hbWVSZWdleCA9IC9eW2EtekEtWjAtOS5fXXsxLDMwfSQvO1xuICAgIGNvbnN0IG5hbWVWZXJpZmllcyA9IHVzZXJOYW1lUmVnZXgudGVzdChuYW1lKTtcblxuXG4gICAgaWYgKG5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH1cblxuICAgIGlmICghbmFtZVZlcmlmaWVzICYmIG5hbWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJOYW1lJyk7XG4gICAgICBzaG93TWVzc2FnZSgnVXNlcm5hbWVzIGNhbiBvbmx5IHVzZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyBhbmQgcGVyaW9kcy4nLCAnZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAoZW1haWwubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ3VzZXJFbWFpbCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAocHdkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2hvd0Vycm9yQ2lyY2xlKCd1c2VyUGFzc3dvcmQnKTtcbiAgICAgICQoJyNlbXB0eUZpZWxkcycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpcm1wd2QubGVuZ3RoID09PSAwKSB7XG4gICAgICBzaG93RXJyb3JDaXJjbGUoJ2NvbmZpcm1QYXNzd29yZCcpO1xuICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG5cbiAgICBpZiAocHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtcHdkLmxlbmd0aCAhPT0gMCAmJiBjb25maXJtcHdkICE9PSBwd2QpIHtcbiAgICAgIHNob3dFcnJvckNpcmNsZSgnY29uZmlybVBhc3N3b3JkJyk7XG4gICAgICAkKCcjZW1wdHlGaWVsZHMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgc2hvd01lc3NhZ2UoJ0NvbmZpcm0gcGFzc3dvcmQgZG9lc25cXCd0IG1hdGNoIHdpdGggcGFzc3dvcmQnLCAnZXJyb3InKTtcbiAgICAgIGlmIChlbWFpbC5sZW5ndGggPT09IDAgfHwgbmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgJCgnI2VtcHR5RmllbGRzJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjb25zdCBlcnJvciA9ICdVc2VybmFtZXMgY2FuIG9ubHkgdXNlIGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzIGFuZCBwZXJpb2RzLic7XG4gICAgLy8gY29uc3QgbmFtZSA9ICdPTElWRSc7XG4gICAgLy8gY29uc3QgcHdkID0gJ09MSVZFJztcbiAgICAvLyBjb25zdCBlbWFpbCA9ICdnZWV0YUBnbWFpbC5jb20nO1xuICAgIGlmIChuYW1lLmxlbmd0aCAhPT0gMCAmJiBwd2QubGVuZ3RoICE9PSAwICYmIGNvbmZpcm1wd2QubGVuZ3RoICE9PSAwICYmXG4gICAgICBlbWFpbC5sZW5ndGggIT09IDAgJiYgcHdkID09PSBjb25maXJtcHdkICYmIG5hbWVWZXJpZmllcykge1xuICAgICAgJC5wb3N0KCcvc2lnbnVwJywge1xuICAgICAgICAgIHVzZXJuYW1lOiBuYW1lLFxuICAgICAgICAgIHBhc3N3b3JkOiBwd2QsXG4gICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5yZXNwb25zZUpTT047XG4gICAgICAgICAgICBpZiAocmVzcG9uc2VUZXh0Lmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgIHNob3dNZXNzYWdlKHJlc3BvbnNlVGV4dFswXS5tc2csICdlcnJvcicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2hvd01lc3NhZ2UocmVzcG9uc2VUZXh0Lm1zZywgJ2Vycm9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YS5tc2csICdtc2cnKTtcbiAgICAgICAgICAkKCcuYnRucycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgJCgnI2xvZ2luTGluaycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGRpc3BsYXlTZWFyY2hCYXIoZSkge1xuICAgIGlmIChlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgJCgnI2hlYWRlckRpdicpLnJlbW92ZUNsYXNzKCdzaG93JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcjc2VhcmNoJykuYWRkQ2xhc3MoJ3Nob3cnKTtcblxuICAgIC8qIGhpZGUgcmVzdCBvZiBkYXRhIGZvciBzZWFyY2ggdmlldyAqL1xuICAgICQoJy5qcy1ub25TZWFyY2hWaWV3JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuanMtc2VhcmNoVmlldycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlU2VhcmNoQmFyKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgJCgnI3NlYXJjaC10ZXh0JykudmFsKCcnKTtcbiAgICAkKCcjaGVhZGVyRGl2JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKS5hZGRDbGFzcygnc2hvdycpO1xuICAgICQoJyNzZWFyY2gnKS5yZW1vdmVDbGFzcygnc2hvdycpO1xuXG4gICAgLyogc2hvdyByZXN0IG9mIGRhdGEgYW5kIGhpZGUgc2VhcmNoIHZpZXcqL1xuICAgICQoJy5qcy1ub25TZWFyY2hWaWV3JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuanMtc2VhcmNoVmlldycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgLy8kKCcuanMtc2VhcmNoVmlldycpLmVtcHR5KCk7XG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCd1c2VyJykgPT09IC0xKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPSAnL3VzZXIvaG9tZSc7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2hvd1VzZXJNZW51RChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IHVzZXJJY29uID0gJCgnI3VzZXItbWVudScpO1xuICAgIGlmICghdXNlckljb24uaGFzQ2xhc3MoJ3Nob3cnKSkge1xuICAgICAgJCgnI3VzZXItbWVudScpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyN1c2VyLW1lbnUnKS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gc2hvd1VzZXJNZW51KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdXNlckljb24gPSAkKCcjdXNlci1tZW51Jyk7XG4gICAgJCgnI3VzZXItbWVudScpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgdXNlckljb24uY3NzKCd3aWR0aCcsICcyNTBweCcpO1xuICAgIHVzZXJJY29uLnByZXBlbmQoJzxkaXYgY2xhc3M9XCJjbG9zZS1pY29uXCI+PGkgY2xhc3M9XCJmaS14XCI+PC9pPjwvZGl2PicpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZVVzZXJNZW51KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdXNlckljb24gPSAkKCcjdXNlci1tZW51Jyk7XG4gICAgJCgnI3VzZXItbWVudScpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgdXNlckljb24uY3NzKCd3aWR0aCcsICcxODBweCcpO1xuICAgICQoJy5jbG9zZS1pY29uJykucmVtb3ZlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBjaGFuZ2VUcmFjayhlKSB7XG4gICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdoaWdobGlnaHQnKSkge1xuICAgICAgLy8gY29uc29sZS5sb2coMSk7XG4gICAgICAkKCcudHJhY2tMaXN0JykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgJCgnLnRyYWNrSXRlbScpLnJlbW92ZUNsYXNzKCdmaS1zb3VuZCcpO1xuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAkKHRoaXMpLmZpbmQoJy50cmFja0l0ZW0nKS5hZGRDbGFzcygnZmktc291bmQnKTtcbiAgICAgIGNvbnN0IHRyYWNrU3JjID0gJCh0aGlzKS5kYXRhKCd0cmFjay1zcmMnKTtcbiAgICAgIC8vY29uc3Qgc3RyID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuICAgICAgLy9jb25zdCBwYXRoID0gc3RyLnN1YnN0cigwLCBzdHIubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgICAvL2NvbnN0IHRyYWNrSWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XG4gICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAgICAgbWVkaWFFbGUucGxheSgpO1xuICAgICAgaGlnaExpZ2h0UHJldk5leHQoKTtcbiAgICAgIC8vaGlzdG9yeS5wdXNoU3RhdGUodHJhY2tJZCwgJycsIHBhdGggKyB0cmFja0lkKTtcbiAgICAgIGNvbnN0IHRyYWNrSWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XG4gICAgICB1cGRhdGVOb09mUGxheXModHJhY2tJZCk7XG4gICAgfVxuXG4gIH1cblxuICAvKipcbiAgICogb24gcG9wc3RhdGUgaGlnaGxpZ2h0IHRoZSBwcm9wZXIgdHJhY2tcbiAgICovXG4gIC8vICQod2luZG93KS5vbigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XG4gIC8vICAgY29uc3QgdHJhY2tJZCA9IGUub3JpZ2luYWxFdmVudC5zdGF0ZTtcbiAgLy8gICBpZiAodHJhY2tJZCAhPT0gbnVsbCkge1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHt0cmFja0lkfWApLmRhdGEoJ3RyYWNrLXNyYycpO1xuICAvLyAgICAgJCgnLnRyYWNrTGlzdCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgLy8gICAgICQoJy50cmFja0l0ZW0nKS5yZW1vdmVDbGFzcygnZmktc291bmQnKTtcbiAgLy8gICAgICQoYCMke3RyYWNrSWR9YCkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAvLyAgICAgJChgIyR7dHJhY2tJZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBjb25zdCBzdHIgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG4gIC8vICAgICBjb25zdCBpZCA9IHN0ci5zdWJzdHIoc3RyLmxhc3RJbmRleE9mKFwiL1wiKSArIDEsIHN0ci5sZW5ndGgpO1xuICAvLyAgICAgY29uc3QgdHJhY2tTcmMgPSAkKGAjJHtpZH1gKS5kYXRhKCd0cmFjay1zcmMnKTtcbiAgLy8gICAgICQoJy50cmFja0xpc3QnKS5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKCcudHJhY2tJdGVtJykucmVtb3ZlQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gIC8vICAgICAkKGAjJHtpZH1gKS5maW5kKCcudHJhY2tJdGVtJykuYWRkQ2xhc3MoJ2ZpLXNvdW5kJyk7XG4gIC8vXG4gIC8vICAgICBtZWRpYUVsZS5zZXRTcmModHJhY2tTcmMpO1xuICAvLyAgICAgbWVkaWFFbGUubG9hZCgpO1xuICAvLyAgICAgbWVkaWFFbGUucGxheSgpO1xuICAvLyAgIH1cbiAgLy8gfSk7XG5cbiAgLyoqXG4gICAqIFNlYXJjaFxuICAgKi9cbiAgZnVuY3Rpb24gY2FsbFNlYXJjaChlKSB7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgIHNlYXJjaChlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZWFyY2goZSwgc3RyLCBwb3BzdGF0ZSkge1xuICAgIGlmIChlICE9PSBudWxsKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgJCgnLmpzLXNlYXJjaFZpZXcnKS5lbXB0eSgpO1xuICAgIHZhciBzZWFyY2hTdHJpbmcgPSAoc3RyICE9PSB1bmRlZmluZWQpID8gc3RyIDogJC50cmltKCQoJyNzZWFyY2gtdGV4dCcpLnZhbCgpKTsgLyogdHJpbSBiZWdpbm5pbmcgYW5kIGVuZGluZyBzcGFjZXMgKi9cbiAgICBzZWFyY2hTdHJpbmcgPSBzZWFyY2hTdHJpbmcucmVwbGFjZSgvXFxzKy9nLCAnICcpO1xuICAgIHNlYXJjaFN0cmluZyA9IGVuY29kZVVSSUNvbXBvbmVudChzZWFyY2hTdHJpbmcpO1xuXG4gICAgaWYgKHNlYXJjaFN0cmluZy5sZW5ndGggPiAwICYmIHNlYXJjaFN0cmluZyAhPT0gJyAnKSB7XG4gICAgICAkLnBvc3QoYC9zZWFyY2gvJHtzZWFyY2hTdHJpbmd9YClcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICQoJyNzZWFyY2hDb250JykuaHRtbChkYXRhKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICQoJyNzZWFyY2hDb250JykuaHRtbChkYXRhKTtcbiAgICAgICAgICAkKCcjanMtc2VhcmNoUmVzdWx0cycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgaWYgKHBvcHN0YXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0ciA9IGAvc2VhcmNoLyR7c2VhcmNoU3RyaW5nfWA7XG4gICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZSh7XG4gICAgICAgICAgICAgIHNlYXJjaDogZGVjb2RlVVJJQ29tcG9uZW50KHNlYXJjaFN0cmluZylcbiAgICAgICAgICAgIH0sICcnLCBzdHIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gY29uc29sZS5sb2cod2luZG93Lmhpc3Rvcnkuc3RhdGUpO1xuICAvLyBjb25zb2xlLmxvZyh3aW5kb3cuaGlzdG9yeSk7XG5cbiAgaWYgKHdpbmRvdy5oaXN0b3J5LnN0YXRlICE9PSBudWxsKSB7XG4gICAgY29uc3Qgc3RhdGUgPSB3aW5kb3cuaGlzdG9yeS5zdGF0ZTtcbiAgICBpZiAoc3RhdGUuc2VhcmNoICE9PSB1bmRlZmluZWQgJiYgc3RhdGUuY2F0ZWdvcnkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZGlzcGxheVNlYXJjaEJhcigpO1xuICAgICAgJCgnI3NlYXJjaC10ZXh0JykudmFsKHN0YXRlLnNlYXJjaCk7XG4gICAgICBzZWFyY2gobnVsbCwgc3RhdGUuc2VhcmNoLCAnbm9Qb3BzdGF0ZScpO1xuICAgIH0gZWxzZSBpZiAoc3RhdGUuc2VhcmNoICE9PSB1bmRlZmluZWQgJiYgc3RhdGUuY2F0ZWdvcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGlzcGxheVNlYXJjaEJhcigpO1xuICAgICAgJCgnI3NlYXJjaC10ZXh0JykudmFsKHN0YXRlLnNlYXJjaCk7XG4gICAgICBzZWVBbGxSZXN1bHRzKG51bGwsIHN0YXRlLnNlYXJjaCwgc3RhdGUuY2F0ZWdvcnksICdub1BvcHN0YXRlJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIG9uIHBvcHN0YXRlIGhpZ2hsaWdodCBnZXQgdGhlIHByb3BlciB2aWV3XG4gICAqL1xuXG4gICQod2luZG93KS5vbigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBlLm9yaWdpbmFsRXZlbnQuc3RhdGU7XG5cbiAgICBpZiAoc3RhdGUgPT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHBhdGggPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcGF0aDtcbiAgICB9IGVsc2UgaWYgKHN0YXRlLnNlYXJjaCAhPT0gdW5kZWZpbmVkICYmIHN0YXRlLmNhdGVnb3J5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGRpc3BsYXlTZWFyY2hCYXIoZSk7XG4gICAgICAkKCcjc2VhcmNoLXRleHQnKS52YWwoc3RhdGUuc2VhcmNoKTtcbiAgICAgIHNlYXJjaChlLCBzdGF0ZS5zZWFyY2gsICdub1BvcHN0YXRlJyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZS5zZWFyY2ggIT09IHVuZGVmaW5lZCAmJiBzdGF0ZS5jYXRlZ29yeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBkaXNwbGF5U2VhcmNoQmFyKGUpO1xuICAgICAgJCgnI3NlYXJjaC10ZXh0JykudmFsKHN0YXRlLnNlYXJjaCk7XG4gICAgICBzZWVBbGxSZXN1bHRzKGUsIHN0YXRlLnNlYXJjaCwgc3RhdGUuY2F0ZWdvcnksICdub1BvcHN0YXRlJyk7XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiBzZWVBbGxSZXN1bHRzKGUsIHNyY2hTdHIsIGNhdGVncnksIHBvcHN0YXRlKSB7XG4gICAgaWYgKGUgIT09IG51bGwpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICB2YXIgc2VhcmNoU3RyID0gKHNyY2hTdHIgIT09IHVuZGVmaW5lZCkgPyBzcmNoU3RyIDogJCgnLnNlYXJjaFN0cicpLmh0bWwoKTtcbiAgICBjb25zdCBjYXRlZ29yeSA9IChjYXRlZ3J5ICE9PSB1bmRlZmluZWQpID8gY2F0ZWdyeSA6ICQodGhpcykuZGF0YSgnY2F0ZWdvcnknKTtcblxuICAgIHNlYXJjaFN0ciA9IGVuY29kZVVSSUNvbXBvbmVudChzZWFyY2hTdHIpO1xuXG4gICAgJC5wb3N0KGAvc2VhcmNoLyR7Y2F0ZWdvcnl9LyR7c2VhcmNoU3RyfWApXG4gICAgICAuZmFpbChmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICQoJyNzZWFyY2hDb250JykuaHRtbChkYXRhKTtcbiAgICAgIH0pXG4gICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICQoJyNzZWFyY2hDb250JykuaHRtbChkYXRhKTtcbiAgICAgICAgJCgnI2pzLXNlYXJjaFJlc3VsdHMnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICBpZiAocG9wc3RhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvbnN0IHN0ciA9IGAvc2VhcmNoLyR7Y2F0ZWdvcnl9LyR7c2VhcmNoU3RyfWA7XG4gICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoe1xuICAgICAgICAgICAgc2VhcmNoOiBkZWNvZGVVUklDb21wb25lbnQoc2VhcmNoU3RyKSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeVxuICAgICAgICAgIH0sICcnLCBzdHIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxpbmtBY3RpdmUoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVBsYXlsaXN0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIH1cblxuICAvKipcbiAgICogVXRpbGl0eSBmdW5jdGlvbnNcbiAgICovXG5cbiAgZnVuY3Rpb24gY2xlYXJNZXNzYWdlKCkge1xuICAgICQoJyNlcnJvcicpLmVtcHR5KCk7XG4gICAgJCgnI21zZycpLmVtcHR5KCk7XG4gICAgJCgnI2VtcHR5RmllbGRzJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkKCcuaWNvbi1lcnJvcicpLnJlbW92ZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd01lc3NhZ2UobXNnVHh0LCBtc2dEaXYpIHtcbiAgICB2YXIgdWxFbGUgPSAkKCcjbXNnY29udCcpO1xuICAgIGlmICh1bEVsZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHVsRWxlID0gJCgnPHVsIGlkPVxcJ21zZ2NvbnRcXCc+PC91bD4nKTtcbiAgICB9XG4gICAgdWxFbGUuYXBwZW5kKCc8bGk+JyArIG1zZ1R4dCArICc8L2xpPicpO1xuICAgICQoJyMnICsgbXNnRGl2KS5odG1sKHVsRWxlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dFcnJvckNpcmNsZShjaXJjbGVJbnApIHtcbiAgICBjb25zdCBpbnBFbGUgPSAkKCcjJyArIGNpcmNsZUlucCk7XG4gICAgY29uc3Qgc3BhbkVsZSA9ICQoJzxzcGFuIGNsYXNzPVxcJ2ljb24tZXJyb3JcXCc+PGkgY2xhc3M9XFwnZmkteC1jaXJjbGVcXCc+PC9pPjwvc3Bhbj4nKTtcbiAgICBpbnBFbGUuYWZ0ZXIoc3BhbkVsZSk7XG4gIH1cblxuXG5cblxufSgpKTtcbiJdfQ==
